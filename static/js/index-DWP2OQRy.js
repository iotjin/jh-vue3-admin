import{b as k,a as ne,j as ie,w as se,c as de,v as re,L as ce,M as pe,N as me}from"./element-plus-BsPKl9cL.js";import{S as ue}from"./index-LYlNRbZ4.js";import{d as ge,r as fe,_ as C,$ as T,i as _e,am as be,o as u,c as he,W as a,P as s,u as l,ae as L,U as g,a as m,Q as f,O as _,V as x,T as ye,R as we,l as xe,bm as Se,bk as ve}from"./@vue-Cr7qNLMI.js";import{l as De,m as ke,_ as Ce}from"./index-DSZN33lD.js";import{d as Te,A as Ee}from"./addDialog-BPyUPMhp.js";import{I as Ie}from"./@iconify-CPlIDRve.js";import"./lodash-es-Blijzk1b.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-C4lJNpQw.js";import"./dayjs-C6J0yRL_.js";import"./@intlify-CHY6szXs.js";import"./@element-plus-BRXcaAil.js";import"./@ctrl-r5W6hzzQ.js";import"./@sxzz-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-uj-hNnAT.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CufQNpwK.js";import"./crypto-js-CYDAzdEe.js";import"./axios-B4uVmeYG.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-Dt-hUQlq.js";import"./vue-Dml5yltN.js";import"./nprogress-E-flP1tB.js";import"./mockjs-DOFpbtyb.js";import"./vite-plugin-mock-WFsnnzUG.js";import"./path-to-regexp-mDz3xsrU.js";import"./select-tree-C4_H0Fw2.js";const F=w=>(Se("data-v-9caf665a"),w=w(),ve(),w),Re={class:"bs-page-body"},Ae=F(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单名称:")],-1)),Ne=F(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单编码:")],-1)),Oe={class:"bs-page-table"},Ve={class:"bs-table-btns"},Le=["onClick"],Fe={style:{color:"#00a0e9","text-decoration":"underline"}},Je=ge({__name:"index",setup(w){const S=fe(),n=C({tableLoading:!1,tableData:[],queryParams:{title:"",code:""},selectedRows:[],isExpandAll:!1,treeProps:{children:"children",hasChildren:"hasChildren"}}),{tableLoading:J,tableData:B,queryParams:y,selectedRows:v,isExpandAll:E,treeProps:P}=T(n),M=C({menuTypeOptions:Te}),{menuTypeOptions:q}=T(M),d=C({isShowDialog:!1,dialogType:"",dialogFormData:{},dialogTreeData:[]}),{isShowDialog:D,dialogType:$,dialogFormData:U,dialogTreeData:z}=T(d),I=e=>e&&e.includes(":"),K=e=>e&&!I(e);_e(()=>{b()});const b=()=>{var e=JSON.parse(JSON.stringify(n.queryParams));console.log(JSON.stringify(e)),n.tableLoading=!0,De(e).then(t=>{n.tableLoading=!1,t.code===2e4?n.tableData=t.data:k.warning(t.msg)}).catch(t=>{n.tableLoading=!1,console.log(JSON.stringify(t))})},j=({row:e,column:t,rowIndex:i,columnIndex:c})=>t.label==="菜单名称"?{textAlign:"left",paddingLeft:"10px"}:{textAlign:"center"},G=({row:e,column:t,rowIndex:i,columnIndex:c})=>({textAlign:t.label==="菜单名称"?"left":"center"}),Q=e=>"b-tag b-tag-"+e.menuType,W=e=>{n.selectedRows=e},H=(e,t)=>{const i=t.findIndex(c=>c.value===e);if(i!==-1)return t[i].label},X=()=>{d.dialogType="add",d.dialogFormData={},d.dialogTreeData=n.tableData,d.isShowDialog=!0},R=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="edit",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},A=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="look",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},N=e=>{var t="";e&&e.id?t=e.title:t=n.selectedRows.map(i=>i.title).join(","),ne.confirm(`确定要删除菜单 ${t} （如果包含子菜单，将一并删除），此操作将永久删除, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var i={ids:[]};if(e&&e.id)i.ids=[e.id];else{const c=n.selectedRows.map(r=>r.id);i.ids=c}Y(i)})},Y=e=>{console.log(JSON.stringify(e)),ke(e).then(t=>{t.code===2e4?(k.success("删除成功!"),b()):k.warning(t.msg)})},Z=()=>{n.isExpandAll=!n.isExpandAll,O(n.tableData,n.isExpandAll)},O=(e,t)=>{e.forEach(i=>{S.value.toggleRowExpansion(i,t),i.children!==void 0&&i.children!==null&&O(i.children,t)})},ee=()=>{S.value.clearSelection()};return(e,t)=>{const i=ie,c=se,r=de,te=re,p=ce,oe=ue,ae=pe,h=be("hasPerm"),le=me;return u(),he("div",Re,[a(te,{inline:!0,model:l(y),class:"bs-form-search mt10"},{default:s(()=>[a(c,null,{default:s(()=>[Ae,a(i,{modelValue:l(y).title,"onUpdate:modelValue":t[0]||(t[0]=o=>l(y).title=o),maxlength:"20",placeholder:"请输入菜单名称",clearable:"",onKeyup:L(b,["enter","native"])},null,8,["modelValue"])]),_:1}),a(c,null,{default:s(()=>[Ne,a(i,{modelValue:l(y).code,"onUpdate:modelValue":t[1]||(t[1]=o=>l(y).code=o),maxlength:"20",placeholder:"请输入菜单编码",clearable:"",onKeyup:L(b,["enter","native"])},null,8,["modelValue"])]),_:1}),a(c,null,{default:s(()=>[a(r,{class:"bs-form-btn",type:"primary",onClick:b},{default:s(()=>[g("查询")]),_:1})]),_:1})]),_:1},8,["model"]),m("div",Oe,[m("div",Ve,[f((u(),_(r,{type:"primary",icon:"i-ep-plus",onClick:X},{default:s(()=>[g(" 新增 ")]),_:1})),[[h,["menu-add"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-edit",disabled:l(v).length!==1,onClick:R},{default:s(()=>[g(" 编辑 ")]),_:1},8,["disabled"])),[[h,["menu-edit"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-search",disabled:l(v).length!==1,onClick:A},{default:s(()=>[g(" 查看 ")]),_:1},8,["disabled"])),[[h,["menu-look"]]]),f((u(),_(r,{type:"danger",icon:"i-ep-delete",disabled:l(v).length!==1,onClick:N},{default:s(()=>[g(" 删除 ")]),_:1},8,["disabled"])),[[h,["menu-delete"]]]),a(r,{plain:"",icon:l(E)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:Z},{default:s(()=>[g(x(l(E)?"全部收起":"全部展开"),1)]),_:1},8,["icon"])]),f((u(),_(ae,{ref_key:"tableRef",ref:S,class:"bs-table",data:l(B),"tree-props":l(P),"row-key":"id","default-expand-all":!1,stripe:!0,"header-cell-style":j,"cell-style":G,onSelectionChange:W},{default:s(()=>[a(p,{type:"selection",width:"55px"}),a(p,{label:"菜单名称","min-width":"200px"},{default:s(o=>[m("span",{onClick:V=>A(o.row)},[m("a",Fe,[I(o.row.icon)?(u(),_(l(Ie),{key:0,icon:o.row.icon,class:"iconFont"},null,8,["icon"])):K(o.row.icon)?(u(),_(oe,{key:1,"icon-class":o.row.icon,class:"iconFont"},null,8,["icon-class"])):ye("",!0),g(" "+x(o.row.title),1)])],8,Le)]),_:1}),a(p,{label:"菜单类型","min-width":"100"},{default:s(o=>[m("div",{class:we(Q(o.row))},x(H(o.row.menuType,l(q))),3)]),_:1}),a(p,{prop:"code",label:"菜单编码","min-width":"170px"}),a(p,{prop:"sort",label:"排序"}),a(p,{label:"可见"},{default:s(o=>[g(x(o.row.menuType==="button"?"":o.row.hidden?"隐藏":"显示"),1)]),_:1}),a(p,{prop:"component",label:"组件路径","min-width":"220px"}),a(p,{prop:"parentTitle",label:"上级菜单"}),a(p,{fixed:"right",label:"操作",width:"120"},{default:s(o=>[f(a(r,{size:"small",icon:"i-ep-edit",onClick:V=>R(o.row)},null,8,["onClick"]),[[h,["menu-edit"]]]),f(a(r,{size:"small",icon:"i-ep-delete",type:"danger",onClick:V=>N(o.row)},null,8,["onClick"]),[[h,["menu-delete"]]])]),_:1})]),_:1},8,["data","tree-props"])),[[le,l(J)]])]),a(Ee,{"dialog-type":l($),"is-show":l(D),"onUpdate:isShow":t[2]||(t[2]=o=>xe(D)?D.value=o:null),"dialog-data":l(U),"dialog-tree-data":l(z),onSuccess:b,onClosed:ee},null,8,["dialog-type","is-show","dialog-data","dialog-tree-data"])])}}}),mt=Ce(Je,[["__scopeId","data-v-9caf665a"]]);export{mt as default};
