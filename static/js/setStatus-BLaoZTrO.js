import{b as J,B,A,W as M,q as F}from"./element-plus-DZ2IrBrA.js";import{b as q}from"./base-cuaEHV6j.js";import{l as z}from"./vue-draggable-plus-DB7mI_zb.js";import{d as K,r as x,_ as P,$ as T,w as $,i as j,c as g,o as S,W as u,S as G,P as L,u as p,l as b,F as H,ab as Q,a as l,V,bm as X,bk as Y}from"./@vue-KIsu0X2L.js";import{_ as Z}from"./index-tUrT1slD.js";import"./lodash-es-gvlvjXa_.js";import"./async-validator-9PlIezaS.js";import"./@vueuse-D4qJsfSX.js";import"./dayjs-CIy0qJcO.js";import"./@intlify-CLUpp_Iz.js";import"./@sxzz-D_chPuIy.js";import"./@element-plus-BU8E8ZTx.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./dict-DCH3enxd.js";import"./pinia-B7D0yCDv.js";import"./vue-router-Zv4ZtmtT.js";import"./crypto-js-CpHmt7sX.js";import"./axios-Br0q4W-C.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-CSWdtZJ9.js";import"./vue-tv3Mw8Sw.js";import"./nprogress-5SZ_0UJX.js";import"./mockjs-BGWc0pdN.js";import"./vite-plugin-mock-CF_1yVIv.js";import"./path-to-regexp-BzK_ZY7n.js";const _=m=>(X("data-v-eeb7d595"),m=m(),Y(),m),tt={class:"app-container"},et=_(()=>l("div",{style:{margin:"10px 0","font-weight":"bold","font-size":"25px"}},"Selected Status:",-1)),st=_(()=>l("div",{style:{"margin-left":"10px","margin-bottom":"10px"}},"Drag to sort status",-1)),at={key:0,class:"dndList"},ot={style:{display:"flex","align-items":"center"}},nt={style:{flex:"9"}},rt={style:{color:"#000","font-weight":"bold"}},lt={style:{color:"#000","margin-top":"10px"}},it=_(()=>l("span",{style:{"margin-right":"5px"}},"Can Read",-1)),dt=_(()=>l("span",{style:{"margin-right":"10px"}},null,-1)),ct=_(()=>l("span",{style:{"margin-right":"5px"}},"Can Write",-1)),ut={style:{color:"#000","font-weight":"bold"}},pt=K({__name:"setStatus",props:{type:{type:String,default:"add"},editStatusList:{type:Array,default:()=>[]}},emits:["change"],setup(m,{emit:I}){const R=I,y=m;x();const w=x(),o=P({statusList:[],selectStatusList:[],ids:[]}),{statusList:k,selectStatusList:f,ids:v}=T(o);$(()=>y.editStatusList,s=>{W(s)},{immediate:!0}),j(()=>{C()});const C=()=>{q().then(s=>{if(s.code===2e4){var e=s.data,a=[];for(let t=0;t<e.length;t++)a.push({key:t,label:e[t].label,value:e[t].value}),y.type==="add"&&(a[t].canRead=!1,a[t].canWrite=!1);o.statusList=JSON.parse(JSON.stringify(a))}else J.warning(s.msg)})};function W(s){if(y.type!=="add"){var e=[];for(let t=0;t<s.length;t++){var a={key:t,label:s[t].statusName,value:s[t].statusId,canRead:s[t].canRead,canWrite:s[t].canWrite,order:s[t].order};const r=o.statusList.findIndex(i=>i.value===s[t].statusId);r!==-1&&(a.key=o.statusList[r].key),e.push(a)}e.sort((t,r)=>t.order!==r.order?t.order-r.order:t.label.localeCompare(r.label));for(let t=0;t<e.length;t++)e[t].order=t;o.ids=e.map(t=>t.key),o.selectStatusList=e}}const E=(s,e)=>{var a="";const t=e.label.toLowerCase();return s&&(a=s.toLowerCase()),t.indexOf(a)>-1},N=(s,e,a)=>{var t=[],r=JSON.parse(JSON.stringify(o.statusList));o.ids.forEach((i,n)=>{const d=o.statusList.findIndex(D=>D.key===i);if(d!==-1){var c=r[d];c.order=n,t.push(c)}}),t.forEach((i,n)=>{const d=o.selectStatusList.findIndex(c=>i.value===c.value);d!==-1&&(t[n].canRead=o.selectStatusList[d].canRead,t[n].canWrite=o.selectStatusList[d].canWrite)}),o.selectStatusList=t,h()},O=s=>{console.log("start",s)},U=s=>{console.log("onEnd",s);for(let a=0;a<o.selectStatusList.length;a++){var e=o.selectStatusList[a];e.order=a,o.selectStatusList[a]=e}h()},h=()=>{console.log("selectStatusList",JSON.stringify(o.selectStatusList));var s=o.selectStatusList.map(e=>({statusId:e.value,canRead:e.canRead,canWrite:e.canWrite,order:e.order}));R("change",s)};return(s,e)=>{const a=M,t=A,r=B,i=F;return S(),g("div",tt,[u(r,null,{default:L(()=>[u(t,{span:22},{default:L(()=>[u(a,{modelValue:p(v),"onUpdate:modelValue":e[0]||(e[0]=n=>b(v)?v.value=n:null),data:p(k),"filter-method":E,titles:["Select All","Status"],"target-order":"push",filterable:"",onChange:N},null,8,["modelValue","data"])]),_:1})]),_:1}),et,st,p(f).length?(S(),g("div",at,[u(p(z),{ref_key:"dragRef",ref:w,modelValue:p(f),"onUpdate:modelValue":e[1]||(e[1]=n=>b(f)?f.value=n:null),"chosen-class":"chosen",onStart:O,onEnd:U},{default:L(()=>[(S(!0),g(H,null,Q(p(f),(n,d)=>(S(),g("div",{key:d,class:"list-item-bg"},[l("div",ot,[l("div",nt,[l("div",rt,V(n.label),1),l("div",lt,[it,u(i,{modelValue:n.canRead,"onUpdate:modelValue":c=>n.canRead=c,onChange:h},null,8,["modelValue","onUpdate:modelValue"]),dt,ct,u(i,{modelValue:n.canWrite,"onUpdate:modelValue":c=>n.canWrite=c,onChange:h},null,8,["modelValue","onUpdate:modelValue"])])]),l("div",ut,V(n.order),1)])]))),128))]),_:1},8,["modelValue"])])):G("",!0)])}}}),Mt=Z(pt,[["__scopeId","data-v-eeb7d595"]]);export{Mt as default};
