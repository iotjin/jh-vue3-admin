import{F as k,y as v,G as I}from"./element-plus-BTXRAC_-.js";import{d as R,r as q,_ as A,$ as E,i as O,c as m,o as d,W as s,P as u,O as $,S as f,u as _,a as b,V as p,U as B,n as V}from"./@vue-KIsu0X2L.js";import{_ as U}from"./index-eLds9Yb_.js";import"./lodash-es-gvlvjXa_.js";import"./async-validator-9PlIezaS.js";import"./@vueuse-D4qJsfSX.js";import"./dayjs-CIy0qJcO.js";import"./@intlify-CLUpp_Iz.js";import"./@sxzz-D_chPuIy.js";import"./@element-plus-BQ5DqatN.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./pinia-B7D0yCDv.js";import"./vue-router-Zv4ZtmtT.js";import"./crypto-js-DkIsdnw7.js";import"./axios-Br0q4W-C.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-CSWdtZJ9.js";import"./vue-tv3Mw8Sw.js";import"./vue-draggable-plus-DB7mI_zb.js";import"./nprogress-5SZ_0UJX.js";import"./mockjs-CidrXOpc.js";import"./vite-plugin-mock-Ckf4sHq3.js";import"./path-to-regexp-BzK_ZY7n.js";const J={class:"app-container"},Q={key:0},W={key:0},j={key:1},z=R({__name:"table5",setup(F){const h=q(),i=A({tableTotal:0,tableLoading:!1,isShowCheckbox:!0,singleOrderData:[],selectedRows:[]}),{tableTotal:G,tableLoading:H,isShowCheckbox:g,singleOrderData:y,selectedRows:K}=E(i);O(()=>{C(),i.singleOrderData=S(i.singleOrderData),i.isShowCheckbox&&i.singleOrderData.length&&h.value.toggleAllSelection()});const C=()=>{i.singleOrderData=[{productId:"1",productName:"testCombo",discount:0,quantity:1,price:200,subTotal:200,discountNotes:"Combo Discount",memberProductDiscount:397,productMemberList:[{productId:"1-1",productName:"testCombo - child1",quantity:1,price:499,subTotal:200,discount:331.83,discountNotes:"Combo Discount"},{productId:"1-2",productName:"testCombo - child2",quantity:2,price:49,subTotal:400,discount:32.58,discountNotes:"Combo Discount"}]},{productId:"2",productName:"product",discount:0,quantity:1,price:89,subTotal:89,discountNotes:"",memberProductDiscount:0,productMemberList:[]}]},S=t=>{var l=[];for(let o=0;o<t.length;o++){t[o].productPlaceholder=t[o].productName;const r=t[o],n={...t[o]};if(delete n.productMemberList,n.isNormalProduct=!r.productMemberList.length,l.push(n),r.productMemberList&&r.productMemberList.length)for(let e=0;e<r.productMemberList.length;e++)r.productMemberList[e].isStart=e===0,r.productMemberList[e].row=r.productMemberList.length,r.productMemberList[e].isChildren=!0,r.productMemberList[e].productPlaceholder="Which includes:",r.productMemberList[e].memberProductDiscount=r.memberProductDiscount,l.push(r.productMemberList[e])}return l},N=t=>{i.selectedRows=t,console.log(JSON.stringify(i.selectedRows))},w=(t,l)=>{const o=!!(t.length&&t.indexOf(l)!==-1);console.log("selected",o)},x=t=>{console.log(JSON.stringify(t))},P=({row:t,column:l,rowIndex:o,columnIndex:r})=>{if(t[0].level===1){t[1].colSpan=2,t[2].colSpan=0;const n=i.isShowCheckbox?2:0;if(r===n)return{display:"none"}}return{textAlign:"center",background:"#E6E6E6"}},D=({row:t,column:l,rowIndex:o,columnIndex:r})=>({textAlign:"center"}),M=({row:t,column:l,rowIndex:o,columnIndex:r})=>{if(r===0&&!(t.isNormalProduct||t.isChildren))return"disabled-column"},L=({row:t,column:l,rowIndex:o,columnIndex:r})=>{if(l.property==="productPlaceholder"&&!t.isChildren)return[1,2];if(l.property==="productName"&&!t.isChildren)return[0,0];if(l.property==="productPlaceholder"&&t.isChildren&&t.isStart)return[t.row,1];if(l.property==="productPlaceholder"&&t.isChildren&&!t.isStart)return[0,0];if(l.label==="Unit Discount"&&t.isChildren&&t.isStart)return[t.row,2];if(l.label==="Unit Discount"&&t.isChildren&&!t.isStart)return[0,0];if(l.label==="Total"&&t.isChildren&&t.isStart)return[0,0];if(l.label==="Total"&&t.isChildren&&!t.isStart)return[0,0]},T=({columns:t,data:l})=>{var o=i.singleOrderData,r=0,n=0;for(let a=0;a<o.length;a++){const c=o[a];(c.isChildren||c.isNormalProduct)&&(r+=c.quantity),(!c.isChildren||c.isNormalProduct)&&(n+=c.subTotal)}const e=[];return e[0]="合计",e[2]="总数量: "+r,e[5]="总金额: $"+n,i.isShowCheckbox||V(()=>{const a=document.querySelectorAll("#table .el-table__footer-wrapper tfoot tr>td");a.length>0&&(a[1].colSpan=1,a[2].style.color="orange")}),e};return(t,l)=>{const o=k,r=v,n=I;return d(),m("div",J,[s(n,{id:"table",ref_key:"tableRef",ref:h,data:_(y),border:"","span-method":L,"header-cell-style":P,"cell-class-name":M,"cell-style":D,"show-summary":"","summary-method":T,onSelectionChange:N,onSelect:w,onSelectAll:x},{default:u(()=>[_(g)?(d(),$(o,{key:0,type:"selection",width:"60"})):f("",!0),s(o,{label:"Product",prop:"productPlaceholder",width:"150"}),s(o,{label:"Product",prop:"productName",align:"center",width:"600"}),s(o,{label:"Quantity",prop:"quantity",align:"center",width:"100"}),s(o,{label:"Price",align:"center",width:"150"},{default:u(e=>[b("span",null,"$"+p(e.row.price),1)]),_:1}),s(o,{label:"Unit Discount",align:"center",width:"150"},{default:u(e=>[e.row.isChildren?(d(),m("div",j,[b("span",null,"Combo Discount: -$"+p(e.row.memberProductDiscount),1)])):(d(),m("div",Q,[b("p",null,"-$"+p(e.row.discount),1),e.row.discountNotes?(d(),m("p",W,[s(r,{size:"small",type:"primary"},{default:u(()=>[B(p(e.row.discountNotes),1)]),_:2},1024)])):f("",!0)]))]),_:1}),s(o,{label:"Total",align:"center",width:"150"},{default:u(e=>[b("span",null,"$"+p(e.row.subTotal),1)]),_:1})]),_:1},8,["data"])])}}}),St=U(z,[["__scopeId","data-v-02fbcfc0"]]);export{St as default};
