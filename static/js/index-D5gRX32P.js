import{b as D,w as ne,k as ie,c as se,v as de,I as re,J as ce,K as pe,a as me}from"./element-plus-DZ2IrBrA.js";import{n as ue,S as ge,o as fe,_ as _e}from"./index-tUrT1slD.js";import{d as be,r as he,_ as C,$ as T,i as ye,an as we,c as xe,o as u,W as a,a as m,P as s,af as J,u as l,U as g,Q as f,O as _,V as x,S as Se,R as ke,l as ve,bm as De,bk as Ce}from"./@vue-KIsu0X2L.js";import{d as Te,A as Ee}from"./addDialog-nFgCc0q0.js";import{I as Ie}from"./@iconify-CWZ2kepd.js";import"./lodash-es-gvlvjXa_.js";import"./async-validator-9PlIezaS.js";import"./@vueuse-D4qJsfSX.js";import"./dayjs-CIy0qJcO.js";import"./@intlify-CLUpp_Iz.js";import"./@sxzz-D_chPuIy.js";import"./@element-plus-BU8E8ZTx.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./pinia-B7D0yCDv.js";import"./vue-router-Zv4ZtmtT.js";import"./crypto-js-CpHmt7sX.js";import"./axios-Br0q4W-C.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-CSWdtZJ9.js";import"./vue-tv3Mw8Sw.js";import"./vue-draggable-plus-DB7mI_zb.js";import"./nprogress-5SZ_0UJX.js";import"./mockjs-BGWc0pdN.js";import"./vite-plugin-mock-CF_1yVIv.js";import"./path-to-regexp-BzK_ZY7n.js";import"./select-tree-DIARKfhL.js";const L=w=>(De("data-v-9caf665a"),w=w(),Ce(),w),Re={class:"bs-page-body"},Ae=L(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单名称:")],-1)),Ne=L(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单编码:")],-1)),Oe={class:"bs-page-table"},Ve={class:"bs-table-btns"},Je=["onClick"],Le={style:{color:"#00a0e9","text-decoration":"underline"}},Fe=be({__name:"index",setup(w){const S=he(),n=C({tableLoading:!1,tableData:[],queryParams:{title:"",code:""},selectedRows:[],isExpandAll:!1,treeProps:{children:"children",hasChildren:"hasChildren"}}),{tableLoading:F,tableData:B,queryParams:y,selectedRows:k,isExpandAll:E,treeProps:P}=T(n),M=C({menuTypeOptions:Te}),{menuTypeOptions:q}=T(M),d=C({isShowDialog:!1,dialogType:"",dialogFormData:{},dialogTreeData:[]}),{isShowDialog:v,dialogType:$,dialogFormData:K,dialogTreeData:U}=T(d),I=e=>e&&e.includes(":"),z=e=>e&&!I(e);ye(()=>{b()});const b=()=>{var e=JSON.parse(JSON.stringify(n.queryParams));console.log(JSON.stringify(e)),n.tableLoading=!0,ue(e).then(t=>{n.tableLoading=!1,t.code===2e4?n.tableData=t.data:D.warning(t.msg)}).catch(t=>{n.tableLoading=!1,console.log(JSON.stringify(t))})},j=({row:e,column:t,rowIndex:i,columnIndex:c})=>t.label==="菜单名称"?{textAlign:"left",paddingLeft:"10px"}:{textAlign:"center"},G=({row:e,column:t,rowIndex:i,columnIndex:c})=>({textAlign:t.label==="菜单名称"?"left":"center"}),Q=e=>"b-tag b-tag-"+e.menuType,W=e=>{n.selectedRows=e},H=(e,t)=>{const i=t.findIndex(c=>c.value===e);if(i!==-1)return t[i].label},X=()=>{d.dialogType="add",d.dialogFormData={},d.dialogTreeData=n.tableData,d.isShowDialog=!0},R=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="edit",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},A=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="look",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},N=e=>{var t="";e&&e.id?t=e.title:t=n.selectedRows.map(i=>i.title).join(","),me.confirm(`确定要删除菜单 ${t} （如果包含子菜单，将一并删除），此操作将永久删除, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var i={ids:[]};if(e&&e.id)i.ids=[e.id];else{const c=n.selectedRows.map(r=>r.id);i.ids=c}Y(i)})},Y=e=>{console.log(JSON.stringify(e)),fe(e).then(t=>{t.code===2e4?(D.success("删除成功!"),b()):D.warning(t.msg)})},Z=()=>{n.isExpandAll=!n.isExpandAll,O(n.tableData,n.isExpandAll)},O=(e,t)=>{e.forEach(i=>{S.value.toggleRowExpansion(i,t),i.children!==void 0&&i.children!==null&&O(i.children,t)})},ee=()=>{S.value.clearSelection()};return(e,t)=>{const i=ie,c=ne,r=se,te=de,p=ce,oe=ge,ae=pe,h=we("hasPerm"),le=re;return u(),xe("div",Re,[a(te,{inline:!0,model:l(y),class:"bs-form-search mt10"},{default:s(()=>[a(c,null,{default:s(()=>[Ae,a(i,{modelValue:l(y).title,"onUpdate:modelValue":t[0]||(t[0]=o=>l(y).title=o),maxlength:"20",placeholder:"请输入菜单名称",clearable:"",onKeyup:J(b,["enter","native"])},null,8,["modelValue"])]),_:1}),a(c,null,{default:s(()=>[Ne,a(i,{modelValue:l(y).code,"onUpdate:modelValue":t[1]||(t[1]=o=>l(y).code=o),maxlength:"20",placeholder:"请输入菜单编码",clearable:"",onKeyup:J(b,["enter","native"])},null,8,["modelValue"])]),_:1}),a(c,null,{default:s(()=>[a(r,{class:"bs-form-btn",type:"primary",onClick:b},{default:s(()=>[g("查询")]),_:1})]),_:1})]),_:1},8,["model"]),m("div",Oe,[m("div",Ve,[f((u(),_(r,{type:"primary",icon:"i-ep-plus",onClick:X},{default:s(()=>[g(" 新增 ")]),_:1})),[[h,["menu-add"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-edit",disabled:l(k).length!==1,onClick:R},{default:s(()=>[g(" 编辑 ")]),_:1},8,["disabled"])),[[h,["menu-edit"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-search",disabled:l(k).length!==1,onClick:A},{default:s(()=>[g(" 查看 ")]),_:1},8,["disabled"])),[[h,["menu-look"]]]),f((u(),_(r,{type:"danger",icon:"i-ep-delete",disabled:l(k).length!==1,onClick:N},{default:s(()=>[g(" 删除 ")]),_:1},8,["disabled"])),[[h,["menu-delete"]]]),a(r,{plain:"",icon:l(E)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:Z},{default:s(()=>[g(x(l(E)?"全部收起":"全部展开"),1)]),_:1},8,["icon"])]),f((u(),_(ae,{ref_key:"tableRef",ref:S,class:"bs-table",data:l(B),"tree-props":l(P),"row-key":"id","default-expand-all":!1,stripe:!0,"header-cell-style":j,"cell-style":G,onSelectionChange:W},{default:s(()=>[a(p,{type:"selection",width:"55px"}),a(p,{label:"菜单名称","min-width":"200px"},{default:s(o=>[m("span",{onClick:V=>A(o.row)},[m("a",Le,[I(o.row.icon)?(u(),_(l(Ie),{key:0,icon:o.row.icon,class:"iconFont"},null,8,["icon"])):z(o.row.icon)?(u(),_(oe,{key:1,"icon-class":o.row.icon,class:"iconFont"},null,8,["icon-class"])):Se("",!0),g(" "+x(o.row.title),1)])],8,Je)]),_:1}),a(p,{label:"菜单类型","min-width":"100"},{default:s(o=>[m("div",{class:ke(Q(o.row))},x(H(o.row.menuType,l(q))),3)]),_:1}),a(p,{prop:"code",label:"菜单编码","min-width":"170px"}),a(p,{prop:"sort",label:"排序"}),a(p,{label:"可见"},{default:s(o=>[g(x(o.row.menuType==="button"?"":o.row.hidden?"隐藏":"显示"),1)]),_:1}),a(p,{prop:"component",label:"组件路径","min-width":"220px"}),a(p,{prop:"parentTitle",label:"上级菜单"}),a(p,{fixed:"right",label:"操作",width:"120"},{default:s(o=>[f(a(r,{size:"small",icon:"i-ep-edit",onClick:V=>R(o.row)},null,8,["onClick"]),[[h,["menu-edit"]]]),f(a(r,{size:"small",icon:"i-ep-delete",type:"danger",onClick:V=>N(o.row)},null,8,["onClick"]),[[h,["menu-delete"]]])]),_:1})]),_:1},8,["data","tree-props"])),[[le,l(F)]])]),a(Ee,{"dialog-type":l($),"is-show":l(v),"onUpdate:isShow":t[2]||(t[2]=o=>ve(v)?v.value=o:null),"dialog-data":l(K),"dialog-tree-data":l(U),onSuccess:b,onClosed:ee},null,8,["dialog-type","is-show","dialog-data","dialog-tree-data"])])}}}),pt=_e(Fe,[["__scopeId","data-v-9caf665a"]]);export{pt as default};
