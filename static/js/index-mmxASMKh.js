import{b as _,a as N,k as me,w as ce,F as fe,G as ge,H as be,c as _e,v as he,I as De,J as we,K as ye}from"./element-plus-CS1bfuXs.js";import{d as ve,r as L,_ as V,$ as q,f as xe,o as h,c as T,a as c,W as a,P as o,u as r,af as Ve,F,ab as H,O as $,l as I,U as D,Q as Se,h as P,bm as Re,bk as ke}from"./@vue-DBL8Ibom.js";import{g as Ye}from"./base-C92tuOvx.js";import{a as Ce}from"./tables-Dxk5sS-t.js";import Te from"./addDialog-DDco_9CL.js";import{T as w}from"./timeUtils-CwNtu00v.js";import{_ as $e}from"./index-BSyJ-IJQ.js";import"./lodash-es-Blijzk1b.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-BThtamsc.js";import"./dayjs-C6J0yRL_.js";import"./@intlify-CHY6szXs.js";import"./@sxzz-D9SI2xQl.js";import"./@element-plus-BmjHI8io.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./dict-BGtSf7-R.js";import"./pinia-7g9vQp6f.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-fhvlCfPF.js";import"./crypto-js-CYDAzdEe.js";import"./axios-CCb-kr4I.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-B8qYdFXi.js";import"./vue-rTnkxsfK.js";import"./vue-draggable-plus-BSvTyIk2.js";import"./nprogress-yi2QV7xY.js";import"./mockjs-DsSR4jwH.js";import"./vite-plugin-mock-CDJiH8Qs.js";import"./path-to-regexp-BzK_ZY7n.js";const O=v=>(Re("data-v-24eb36f4"),v=v(),ke(),v),Oe={class:"bs-page-body"},Ue=O(()=>c("span",{class:"bs-form-label",style:{width:"80px"}},[c("span",{class:"icon"},"姓名:")],-1)),Ee=O(()=>c("span",{class:"bs-form-label",style:{width:"80px"}},[c("span",{class:"icon"},"部门:")],-1)),Be=O(()=>c("span",{class:"bs-form-label",style:{width:"100px"}},[c("span",{class:"icon"},"创建时间:")],-1)),Me={class:"bs-page-table"},Je={class:"bs-table-btns"},Ne={class:"bs-dialog-footer",align:"center",style:{padding:"20px"}},Le=ve({__name:"index",setup(v){const S=L(),U=L(),d=V({tableTotal:0,tableLoading:!1,tableData0:[],queryParams:{page:1,limit:10,startDate:"",endDate:"",name:"",dept:""},dateRange:[],selectedRows:[],submitBtnLoading:!1,isShowDialog:!1,dialogType:"add",dialogFormData:{}}),{tableLoading:A,tableData0:qe,queryParams:y,dateRange:R,selectedRows:z,submitBtnLoading:K,isShowDialog:k,dialogType:j,dialogFormData:G}=q(d),E=V({deptOptions:[],levelOptions:[]}),{deptOptions:B,levelOptions:Fe}=q(E),u=V({tableData:[]}),g=V({name:[{required:!0,message:"请输入名称",trigger:"blur"}],dept:[{required:!0,message:"请选择部门",trigger:"change"}],operator:[{required:!0,message:"请输入操作人名称",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}],createDate:[{validator:(l,e,s)=>{if(!e)s(new Error("请选择创建时间"));else{var n=l.field.substr(10,1),p=u.tableData[n].updateDate,x=w.Jh_compareTimes(e,p);x&&s(new Error("创建时间不能大于操作时间!")),s()}},trigger:"change"}],updateDate:[{validator:(l,e,s)=>{if(!e)s(new Error("请选择操作时间"));else{var n=l.field.substr(10,1),p=w.Jh_compareTimes(e,u.tableData[n].createDate);p||s(new Error("操作时间不能小于创建时间!")),s()}},trigger:"change"}]});xe(()=>{Q(),Y()});const Q=()=>{Ye().then(l=>{l.code===2e4?E.deptOptions=l.data:_.warning(l.msg)})},Y=()=>{var l=JSON.parse(JSON.stringify(d.queryParams));l.startDate=d.dateRange?w.startOfDay(d.dateRange[0]):"",l.endDate=d.dateRange?w.endOfDay(d.dateRange[1]):"",console.log("参数："+JSON.stringify(l)),d.tableLoading=!0,Ce(l).then(e=>{if(d.tableLoading=!1,e.code===2e4){var s=[];for(let p=0;p<2;p++){var n=p+1;s.push({xh:p+1,id:n.toString(),name:"名称"+n,dept:"dept"+n,operator:"操作人"+n,content:"内容"+n,createDate:w.Jh_timeStampToTime(new Date().getTime(),"{y}-{m}-{d} {h}:{i}:{s}"),updateDate:w.Jh_timeStampToTime(new Date().getTime()+1e3*3600*24,"{y}-{m}-{d} {h}:{i}:{s}")})}u.tableData=s}else _.warning(e.msg)}).catch(e=>{d.tableLoading=!1,console.log(JSON.stringify(e))})},M=()=>{d.queryParams.page=1,Y()},W=l=>{d.selectedRows=l},X=({row:l,column:e,rowIndex:s,columnIndex:n})=>s===0&&n===0?{textAlign:"center",background:"#eef1f6",display:"none"}:{textAlign:"center",background:"#f5f5f5"},Z=({row:l,column:e,rowIndex:s,columnIndex:n})=>({textAlign:"center"}),ee=({row:l,rowIndex:e})=>{l.xh=e+1},b=({column:l,$index:e})=>[P("span",{style:"color: red"},"*"),P("span"," "+l.label)],te=()=>{var l={xh:0,id:"",name:"",dept:"",operator:"",content:"",createDate:"",updateDate:""};u.tableData.push(l)},ae=()=>{if(d.selectedRows.length===0){_.warning("请选择记录");return}N.confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var l=[];for(let e=0;e<d.selectedRows.length;e++)l.push(d.selectedRows[e].xh);l.sort(function(e,s){return e-s}),console.log("新数组排序后："+l);for(let e=0;e<l.length;e++)u.tableData.splice(l[e]-e-1,1);_.success("删除成功!")}).catch(()=>{})},le=l=>{console.log(JSON.stringify(l))},oe=l=>{console.log(JSON.stringify(l)),N.confirm(`确定要删除用户 ${l.name} ，此操作将永久删除, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{u.tableData.splice(Number(l.xh)-1,1),_.success("删除成功!")}).catch(()=>{})},ne=()=>{S.value.resetFields()},re=()=>{S.value.validate((l,e)=>{l?(console.log("submit!"),se()):(console.log("error submit!",e),_.warning("有未输入项!"))})},se=()=>{console.log("验证通过 开始提交数据 。。。submitRequest"),console.log("tableform",JSON.stringify(u)),d.submitBtnLoading=!0,setTimeout(()=>{d.submitBtnLoading=!1},2e3)},de=()=>{d.dialogFormData=JSON.parse(JSON.stringify(u)),d.dialogType="edit",d.isShowDialog=!0},ie=()=>{U.value.clearSelection()};return(l,e)=>{const s=me,n=ce,p=fe,x=ge,C=be,f=_e,J=he,m=De,pe=we,ue=ye;return h(),T("div",null,[c("div",Oe,[a(J,{inline:!0,model:r(y),class:"bs-form-search mt10"},{default:o(()=>[a(n,null,{default:o(()=>[Ue,a(s,{modelValue:r(y).name,"onUpdate:modelValue":e[0]||(e[0]=t=>r(y).name=t),maxlength:"20",placeholder:"请输入",clearable:"",onKeyup:Ve(M,["enter","native"])},null,8,["modelValue"])]),_:1}),a(n,null,{default:o(()=>[Ee,a(x,{modelValue:r(y).dept,"onUpdate:modelValue":e[1]||(e[1]=t=>r(y).dept=t),placeholder:"请选择",filterable:"",clearable:""},{default:o(()=>[(h(!0),T(F,null,H(r(B),t=>(h(),$(p,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,null,{default:o(()=>[Be,a(C,{modelValue:r(R),"onUpdate:modelValue":e[2]||(e[2]=t=>I(R)?R.value=t:null),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",format:"YYYY年MM月DD日"},null,8,["modelValue"])]),_:1}),a(n,null,{default:o(()=>[a(f,{class:"bs-form-btn",type:"primary",onClick:M},{default:o(()=>[D("查询")]),_:1})]),_:1})]),_:1},8,["model"]),c("div",Me,[c("div",Je,[a(f,{type:"primary",icon:"i-ep-plus",onClick:te},{default:o(()=>[D(" 新增 ")]),_:1}),a(f,{type:"danger",icon:"i-ep-delete",disabled:r(z).length==0,onClick:ae},{default:o(()=>[D(" 删除 ")]),_:1},8,["disabled"]),a(f,{type:"primary",icon:"i-ep-edit",onClick:de},{default:o(()=>[D(" 弹框添加 ")]),_:1})]),a(J,{ref_key:"formRef",ref:S,model:r(u),"label-width":"120px",inline:!0,rules:r(g),size:"default","label-position":"left"},{default:o(()=>[Se((h(),$(pe,{ref_key:"tableRef",ref:U,class:"my-table",data:r(u).tableData,stripe:!0,"header-cell-style":X,"cell-style":Z,"row-class-name":ee,border:"",onSelectionChange:W},{default:o(()=>[a(m,{label:""},{default:o(()=>[a(m,{type:"index",label:"序号",prop:"xh",width:"80px"}),a(m,{type:"selection",width:"55px",label:""}),a(m,{label:"名称","render-header":b,"min-width":"260"},{default:o(t=>[a(n,{prop:`tableData.${t.$index}.name`,rules:r(g).name,style:{width:"200px"}},{default:o(()=>[a(s,{modelValue:t.row.name,"onUpdate:modelValue":i=>t.row.name=i,maxlength:"20",placeholder:"请输入",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),a(m,{label:"部门","render-header":b,"min-width":"260"},{default:o(t=>[a(n,{prop:`tableData.${t.$index}.dept`,rules:r(g).dept},{default:o(()=>[a(x,{modelValue:t.row.dept,"onUpdate:modelValue":i=>t.row.dept=i,placeholder:"请选择","collapse-tags":"",clearable:"",style:{width:"200px"}},{default:o(()=>[(h(!0),T(F,null,H(r(B),i=>(h(),$(p,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),a(m,{label:"操作人","render-header":b,"min-width":"260"},{default:o(t=>[a(n,{prop:`tableData.${t.$index}.operator`,rules:r(g).operator,style:{width:"200px"}},{default:o(()=>[a(s,{modelValue:t.row.operator,"onUpdate:modelValue":i=>t.row.operator=i,maxlength:"10",placeholder:"请输入",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),a(m,{label:"内容","render-header":b,"min-width":"260"},{default:o(t=>[a(n,{prop:`tableData.${t.$index}.content`,rules:r(g).content},{default:o(()=>[a(s,{modelValue:t.row.content,"onUpdate:modelValue":i=>t.row.content=i,maxlength:"100",placeholder:"请输入",type:"textarea",autosize:{minRows:2,maxRows:2},clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),a(m,{label:"创建时间","render-header":b,width:"260"},{default:o(t=>[a(n,{prop:`tableData.${t.$index}.createDate`,rules:r(g).createDate},{default:o(()=>[a(C,{modelValue:t.row.createDate,"onUpdate:modelValue":i=>t.row.createDate=i,type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD HH:mm",placeholder:"选择日期"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),a(m,{label:"操作时间","render-header":b,width:"260"},{default:o(t=>[a(n,{prop:`tableData.${t.$index}.updateDate`,rules:r(g).updateDate},{default:o(()=>[a(C,{modelValue:t.row.updateDate,"onUpdate:modelValue":i=>t.row.updateDate=i,type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD HH:mm",placeholder:"选择日期"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),a(m,{fixed:"right",label:"操作",width:"120px"},{default:o(t=>[a(f,{size:"small",icon:"i-ep-edit",onClick:i=>le(t.row)},null,8,["onClick"]),a(f,{size:"small",icon:"i-ep-delete",type:"danger",onClick:i=>oe(t.row)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["data"])),[[ue,r(A)]])]),_:1},8,["model","rules"]),c("div",Ne,[a(f,{loading:r(K),type:"primary",onClick:e[3]||(e[3]=t=>re())},{default:o(()=>[D("保存")]),_:1},8,["loading"]),a(f,{type:"primary",onClick:e[4]||(e[4]=t=>ne())},{default:o(()=>[D("重置")]),_:1})])]),a(Te,{"is-show":r(k),"onUpdate:isShow":e[5]||(e[5]=t=>I(k)?k.value=t:null),"dialog-type":r(j),"dialog-data":r(G),"jump-page":"table2页面",onSuccess:Y,onClosed:ie},null,8,["is-show","dialog-type","dialog-data"])])])}}}),wt=$e(Le,[["__scopeId","data-v-24eb36f4"]]);export{wt as default};
