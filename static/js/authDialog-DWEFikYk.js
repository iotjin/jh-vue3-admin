import{d as z,U as X,V as Y,c as Z,_ as ee,I as oe,b as y}from"./element-plus-DZ2IrBrA.js";import{S as te,m as ae,_ as le}from"./index-tUrT1slD.js";import{r as se}from"./role--L_yTHXo.js";import{I as ie}from"./@iconify-CWZ2kepd.js";import{d as ne,r as ce,_ as de,$ as x,w as k,c as L,o as f,W as l,u as a,l as C,P as s,Q as re,a as r,V as _,U as p,O as I,S as pe}from"./@vue-KIsu0X2L.js";import"./lodash-es-gvlvjXa_.js";import"./async-validator-9PlIezaS.js";import"./@vueuse-D4qJsfSX.js";import"./dayjs-CIy0qJcO.js";import"./@intlify-CLUpp_Iz.js";import"./@sxzz-D_chPuIy.js";import"./@element-plus-BU8E8ZTx.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./pinia-B7D0yCDv.js";import"./vue-router-Zv4ZtmtT.js";import"./crypto-js-CpHmt7sX.js";import"./axios-Br0q4W-C.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-CSWdtZJ9.js";import"./vue-tv3Mw8Sw.js";import"./vue-draggable-plus-DB7mI_zb.js";import"./nprogress-5SZ_0UJX.js";import"./mockjs-BGWc0pdN.js";import"./vite-plugin-mock-CF_1yVIv.js";import"./path-to-regexp-BzK_ZY7n.js";const me={class:"bs-dialog"},ue={style:{margin:"-10px 0px 20px"}},ge={style:{padding:"0 5px 15px"}},fe={class:"tree-body"},_e={class:"bs-dialog-footer"},he=ne({__name:"authDialog",props:{isShow:{type:Boolean,default:!1},dialogData:{type:Object,default:()=>({})}},emits:["update:isShow","closed","success"],setup(N,{emit:A}){const h=A,v=N,n=ce(),e=de({dialogTitle:"权限设置",isShowDialog:!1,dialogSubmitBtnLoading:!1,dialogLoading:!1,roleData:{},menuTreeData:[],menuIdList:[],defaultProps:{label:"title",children:"children"},isExpandAll:!1,isSelectAll:!1,activeName:"first"}),{dialogTitle:E,isShowDialog:m,dialogSubmitBtnLoading:T,dialogLoading:V,roleData:B}=x(e),{menuTreeData:O,menuIdList:R,defaultProps:J,isExpandAll:D,isSelectAll:b,activeName:S}=x(e),w=t=>t&&t.includes(":"),P=t=>t&&!w(t);k(()=>v.isShow,t=>{e.isShowDialog=t}),k(()=>e.isShowDialog,t=>{h("update:isShow",t)}),k(()=>v.dialogData,t=>{e.roleData=JSON.parse(JSON.stringify(t))});const U=()=>{M()},K=()=>{h("closed",{})},M=()=>{const t={roleId:e.roleData.id};e.dialogLoading=!0,ae(t).then(o=>{e.dialogLoading=!1,o.code===2e4?(e.menuTreeData=o.data.menuTree,e.menuIdList=o.data.menuIds):y.warning(o.msg)}).catch(o=>{e.dialogLoading=!1,console.log(JSON.stringify(o))})},$=()=>{e.isExpandAll=!e.isExpandAll;const t=n.value.store._getAllNodes();for(var o=0;o<t.length;o++)t[o].expanded=e.isExpandAll},q=()=>{e.isSelectAll=!e.isSelectAll,e.isSelectAll?n.value.setCheckedNodes(e.menuTreeData):n.value.setCheckedNodes([])},F=()=>{H()},H=()=>{const t=e.roleData.id,o=n.value.getCheckedKeys(),c=n.value.getHalfCheckedKeys(),u={roleId:t,menuIds:o.concat(c)};console.log(JSON.stringify(u)),e.dialogSubmitBtnLoading=!0,se(u).then(d=>{e.dialogSubmitBtnLoading=!1,d.code===2e4?(y.success("角色设置权限成功!"),e.isShowDialog=!1,h("success",{})):y.warning(d.msg)}).catch(d=>{e.dialogSubmitBtnLoading=!1,console.log(JSON.stringify(d))})};return(t,o)=>{const c=Z,u=te,d=ee,j=Y,G=X,Q=z,W=oe;return f(),L("div",null,[l(Q,{title:a(E),modelValue:a(m),"onUpdate:modelValue":o[3]||(o[3]=i=>C(m)?m.value=i:null),top:"8vh",width:"55%","close-on-click-modal":!1,onOpened:U,onClosed:K},{default:s(()=>[re((f(),L("div",me,[r("div",ue,"选中角色："+_(a(B).name),1),l(G,{modelValue:a(S),"onUpdate:modelValue":o[0]||(o[0]=i=>C(S)?S.value=i:null),type:"card"},{default:s(()=>[l(j,{label:"菜单权限",name:"first"},{default:s(()=>[r("div",ge,[l(c,{type:"primary",icon:a(D)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:$},{default:s(()=>[p(_(a(D)?"全部收起":"全部展开"),1)]),_:1},8,["icon"]),l(c,{type:"primary",icon:a(b)?"i-ep-close":"i-ep-check",onClick:q},{default:s(()=>[p(_(a(b)?"全部取消":"全部选择"),1)]),_:1},8,["icon"])]),r("div",fe,[l(d,{ref_key:"treeRef",ref:n,data:a(O),"show-checkbox":"","check-on-click-node":!0,"node-key":"id","highlight-current":"","default-checked-keys":a(R),props:a(J)},{default:s(({node:i,data:g})=>[r("span",null,[w(g.icon)?(f(),I(a(ie),{key:0,icon:g.icon,class:"iconFont"},null,8,["icon"])):P(g.icon)?(f(),I(u,{key:1,"icon-class":g.icon,class:"iconFont"},null,8,["icon-class"])):pe("",!0),p(" "+_(i.label),1)])]),_:1},8,["data","default-checked-keys","props"])])]),_:1})]),_:1},8,["modelValue"]),r("div",_e,[l(c,{onClick:o[1]||(o[1]=i=>m.value=!1)},{default:s(()=>[p("取消")]),_:1}),l(c,{loading:a(T),type:"primary",onClick:o[2]||(o[2]=i=>F())},{default:s(()=>[p("保存")]),_:1},8,["loading"])])])),[[W,a(V)]])]),_:1},8,["title","modelValue"])])}}}),Fe=le(he,[["__scopeId","data-v-d1c14b2f"]]);export{Fe as default};
