import{c as R,b as oe,h as le,v as ae,w as ie,u as se,J as ne,g as de,d as re,e as ce,f as pe,K as me,L as ue}from"./element-plus-5134355a.js";import{_ as ge}from"./index-d22ffee2.js";import{d as _e,r as fe,$ as V,a0 as A,i as be,ao as he,o as _,c as we,X as l,Q as i,u as a,af as P,V as m,a as d,R as c,P as b,W as x,Y as ye,l as B}from"./@vue-7d0fc2b4.js";import{g as Se,d as De}from"./role-65b720e2.js";import{_ as ke}from"./addDialog.vuevuetypescriptsetuptruelang-af2be337.js";import Ce from"./authDialog-d33c8d13.js";import"./lodash-es-d29772ce.js";import"./async-validator-dee29e8b.js";import"./@vueuse-d1e6df39.js";import"./dayjs-78f57161.js";import"./@intlify-999e9484.js";import"./source-map-7d7e1c08.js";import"./@element-plus-14994921.js";import"./@ctrl-f8748455.js";import"./@sxzz-c75af06c.js";import"./escape-html-bdfaebd7.js";import"./normalize-wheel-es-ed76fb12.js";import"./plugin-vueexport-helper-c27b6911.js";import"./index-95317ba3.js";import"./pinia-4649f5ad.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-98b533fa.js";import"./axios-4a70c6fc.js";import"./vue-i18n-625cf0a6.js";import"./vue-ff9293da.js";import"./js-cookie-edb2da2a.js";import"./nprogress-941844a1.js";import"./mockjs-3c670f17.js";import"./vite-plugin-mock-8bbc2346.js";import"./path-to-regexp-36ea9d8d.js";import"./index-24a8e899.js";import"./@iconify-5142df58.js";const ve={class:"bs-page-body"},Re=d("span",{class:"bs-form-label",style:{width:"120px"}},[d("span",{class:"icon"},"角色名称:")],-1),xe=d("span",{class:"bs-form-label",style:{width:"120px"}},[d("span",{class:"icon"},"角色编码:")],-1),Ne={class:"bs-page-table"},Ee={class:"bs-table-btns"},Te=["onClick"],Je={style:{color:"#00a0e9","text-decoration":"underline"}},Oe={class:"bs-tooltip-text"},Le=d("span",{style:{"padding-left":"10px"}},null,-1),Ve=d("i",{class:"i-ep-arrow-down el-icon--right"},null,-1),Ae=d("i",{class:"i-ep-setting"},null,-1),_t=_e({__name:"index",setup(Pe){const N=fe(),n=V({tableTotal:0,tableLoading:!1,tableData:[],queryParams:{page:1,limit:10,name:"",code:""},selectedRows:[]}),{tableTotal:E,tableLoading:F,tableData:$,queryParams:p,selectedRows:y}=A(n),s=V({isShowDialog:!1,dialogType:"add",dialogFormData:{},isShowDialogAuthRole:!1,authRoleData:{}}),{isShowDialog:D,dialogType:q,dialogFormData:K,isShowDialogAuthRole:k,authRoleData:U}=A(s);be(()=>{h()});const h=()=>{var t=JSON.parse(JSON.stringify(n.queryParams));console.log(JSON.stringify(t)),n.tableLoading=!0,Se(t).then(e=>{n.tableLoading=!1,e.code===2e4?(n.tableData=e.data,n.tableTotal=e.total):R.warning(e.msg)}).catch(e=>{n.tableLoading=!1,console.log(JSON.stringify(e))})},C=()=>{n.queryParams.page=1,h()},S=t=>!t.code.toLowerCase().includes("admin"),M=t=>{n.selectedRows=t},z=()=>{s.dialogType="add",s.dialogFormData={},s.isShowDialog=!0},T=t=>{const e=JSON.parse(JSON.stringify(t&&t.id?t:n.selectedRows[0]));s.dialogType="edit",s.dialogFormData=e,s.isShowDialog=!0},I=t=>{const e=JSON.parse(JSON.stringify(t&&t.id?t:n.selectedRows[0]));s.dialogType="look",s.dialogFormData=e,s.isShowDialog=!0},J=t=>{var e="";t&&t.id?e=t.name:e=n.selectedRows.map(u=>u.name).join(","),oe.confirm(`确定要删除角色 ${e} ，此操作将永久删除, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var u={ids:[]};if(t&&t.id)u.ids=[t.id];else{const w=n.selectedRows.map(r=>r.id);u.ids=w}j(u)})},j=t=>{console.log(JSON.stringify(t)),De(t).then(e=>{e.code===2e4?(R.success("删除成功!"),h()):R.warning(e.msg)})},O=t=>{const e=JSON.parse(JSON.stringify(t&&t.id?t:n.selectedRows[0]));s.authRoleData=e,s.isShowDialogAuthRole=!0},Q=t=>{s.dialogType="look",s.dialogFormData=JSON.parse(JSON.stringify(t)),s.isShowDialog=!0},L=()=>{N.value.clearSelection()};return(t,e)=>{const u=le,w=ae,r=ie,W=se,f=ne,X=de,Y=re,G=ce,H=pe,Z=me,ee=ge,g=he("hasPerm"),te=ue;return _(),we("div",ve,[l(W,{inline:!0,model:a(p),class:"bs-form-search mt10"},{default:i(()=>[l(w,null,{default:i(()=>[Re,l(u,{modelValue:a(p).name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(p).name=o),maxlength:"20",placeholder:"请输入角色名称",clearable:"",onKeyup:P(C,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),l(w,null,{default:i(()=>[xe,l(u,{modelValue:a(p).code,"onUpdate:modelValue":e[1]||(e[1]=o=>a(p).code=o),maxlength:"20",placeholder:"请输入角色编码",clearable:"",onKeyup:P(C,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),l(w,null,{default:i(()=>[l(r,{class:"bs-form-btn",type:"primary",onClick:C},{default:i(()=>[m("查询")]),_:1})]),_:1})]),_:1},8,["model"]),d("div",Ne,[d("div",Ee,[c((_(),b(r,{type:"primary",icon:"i-ep-plus",onClick:z},{default:i(()=>[m(" 新增 ")]),_:1})),[[g,["role-add"]]]),c((_(),b(r,{type:"primary",icon:"i-ep-edit",disabled:a(y).length!==1,onClick:T},{default:i(()=>[m(" 编辑 ")]),_:1},8,["disabled"])),[[g,["role-edit"]]]),c((_(),b(r,{type:"primary",icon:"i-ep-search",disabled:a(y).length!==1,onClick:I},{default:i(()=>[m(" 查看 ")]),_:1},8,["disabled"])),[[g,["role-look"]]]),c((_(),b(r,{type:"danger",icon:"i-ep-delete",disabled:a(y).length==0,onClick:J},{default:i(()=>[m(" 删除 ")]),_:1},8,["disabled"])),[[g,["role-delete"]]]),c((_(),b(r,{type:"warning",icon:"i-ep-setting",disabled:a(y).length!==1,onClick:O},{default:i(()=>[m(" 权限配置 ")]),_:1},8,["disabled"])),[[g,["role-setting"]]])]),c((_(),b(Z,{ref_key:"tableRef",ref:N,class:"bs-table",data:a($),stripe:!0,"header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},onSelectionChange:M},{default:i(()=>[l(f,{prop:"number",type:"index",label:"序号","min-width":"60"}),l(f,{type:"selection",width:"55",selectable:S}),l(f,{label:"角色名称",width:""},{default:i(o=>[d("span",{onClick:v=>Q(o.row)},[d("a",Je,x(o.row.name),1)],8,Te)]),_:1}),l(f,{prop:"code",label:"角色编码",width:""}),l(f,{label:"是否内置"},{default:i(o=>[m(x(o.row.builtin==="0"?"否":"是"),1)]),_:1}),l(f,{label:"备注","min-width":"100"},{default:i(o=>[l(X,{"visible-arrow":!1,effect:"light",content:o.row.notes,placement:"bottom"},{default:i(()=>[d("span",Oe,x(o.row.notes),1)]),_:2},1032,["content"])]),_:1}),l(f,{fixed:"right",label:"操作",width:"220"},{default:i(o=>[c(l(r,{size:"small",icon:"i-ep-edit",disabled:!S(o.row),onClick:v=>T(o.row)},null,8,["disabled","onClick"]),[[g,["role-edit"]]]),c(l(r,{size:"small",icon:"i-ep-delete",type:"danger",disabled:!S(o.row),onClick:v=>J(o.row)},null,8,["disabled","onClick"]),[[g,["role-delete"]]]),Le,l(H,null,{dropdown:i(()=>[c((_(),b(G,null,{default:i(()=>[l(Y,{onClick:v=>O(o.row)},{default:i(()=>[Ae,m("权限配置")]),_:2},1032,["onClick"])]),_:2},1024)),[[g,["role-setting"]]])]),default:i(()=>[l(r,{size:"small",disabled:!S(o.row)},{default:i(()=>[m(" 更多 "),Ve]),_:2},1032,["disabled"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[te,a(F)]]),c(l(ee,{total:a(E),page:a(p).page,"onUpdate:page":e[2]||(e[2]=o=>a(p).page=o),limit:a(p).limit,"onUpdate:limit":e[3]||(e[3]=o=>a(p).limit=o),onPagination:h},null,8,["total","page","limit"]),[[ye,a(E)>0]])]),l(ke,{"dialog-type":a(q),"is-show":a(D),"onUpdate:isShow":e[4]||(e[4]=o=>B(D)?D.value=o:null),"dialog-data":a(K),onSuccess:h,onClosed:L},null,8,["dialog-type","is-show","dialog-data"]),l(Ce,{"is-show":a(k),"onUpdate:isShow":e[5]||(e[5]=o=>B(k)?k.value=o:null),"dialog-data":a(U),onSuccess:h,onClosed:L},null,8,["is-show","dialog-data"])])}}});export{_t as default};
