import{b as J,V as B,A,B as M,q as F}from"./element-plus-CS1bfuXs.js";import{b as T}from"./base-C92tuOvx.js";import{l as q}from"./vue-draggable-plus-BSvTyIk2.js";import{d as z,r as x,_ as K,$ as P,w as $,f as j,o as g,c as S,W as u,P as L,u as p,l as V,F as G,ab as H,a as l,V as b,T as Q,bm as X,bk as Y}from"./@vue-DBL8Ibom.js";import{_ as Z}from"./index-BSyJ-IJQ.js";import"./lodash-es-Blijzk1b.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-BThtamsc.js";import"./dayjs-C6J0yRL_.js";import"./@intlify-CHY6szXs.js";import"./@sxzz-D9SI2xQl.js";import"./@element-plus-BmjHI8io.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./dict-BGtSf7-R.js";import"./pinia-7g9vQp6f.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-fhvlCfPF.js";import"./crypto-js-CYDAzdEe.js";import"./axios-CCb-kr4I.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-B8qYdFXi.js";import"./vue-rTnkxsfK.js";import"./nprogress-yi2QV7xY.js";import"./mockjs-DsSR4jwH.js";import"./vite-plugin-mock-CDJiH8Qs.js";import"./path-to-regexp-BzK_ZY7n.js";const _=m=>(X("data-v-eeb7d595"),m=m(),Y(),m),tt={class:"app-container"},et=_(()=>l("div",{style:{margin:"10px 0","font-weight":"bold","font-size":"25px"}},"Selected Status:",-1)),st=_(()=>l("div",{style:{"margin-left":"10px","margin-bottom":"10px"}},"Drag to sort status",-1)),at={key:0,class:"dndList"},ot={style:{display:"flex","align-items":"center"}},nt={style:{flex:"9"}},rt={style:{color:"#000","font-weight":"bold"}},lt={style:{color:"#000","margin-top":"10px"}},it=_(()=>l("span",{style:{"margin-right":"5px"}},"Can Read",-1)),dt=_(()=>l("span",{style:{"margin-right":"10px"}},null,-1)),ct=_(()=>l("span",{style:{"margin-right":"5px"}},"Can Write",-1)),ut={style:{color:"#000","font-weight":"bold"}},pt=z({__name:"setStatus",props:{type:{type:String,default:"add"},editStatusList:{type:Array,default:()=>[]}},emits:["change"],setup(m,{emit:I}){const R=I,y=m;x();const w=x(),o=K({statusList:[],selectStatusList:[],ids:[]}),{statusList:k,selectStatusList:f,ids:v}=P(o);$(()=>y.editStatusList,s=>{E(s)},{immediate:!0}),j(()=>{C()});const C=()=>{T().then(s=>{if(s.code===2e4){var e=s.data,a=[];for(let t=0;t<e.length;t++)a.push({key:t,label:e[t].label,value:e[t].value}),y.type==="add"&&(a[t].canRead=!1,a[t].canWrite=!1);o.statusList=JSON.parse(JSON.stringify(a))}else J.warning(s.msg)})};function E(s){if(y.type!=="add"){var e=[];for(let t=0;t<s.length;t++){var a={key:t,label:s[t].statusName,value:s[t].statusId,canRead:s[t].canRead,canWrite:s[t].canWrite,order:s[t].order};const r=o.statusList.findIndex(i=>i.value===s[t].statusId);r!==-1&&(a.key=o.statusList[r].key),e.push(a)}e.sort((t,r)=>t.order!==r.order?t.order-r.order:t.label.localeCompare(r.label));for(let t=0;t<e.length;t++)e[t].order=t;o.ids=e.map(t=>t.key),o.selectStatusList=e}}const W=(s,e)=>{var a="";const t=e.label.toLowerCase();return s&&(a=s.toLowerCase()),t.indexOf(a)>-1},N=(s,e,a)=>{var t=[],r=JSON.parse(JSON.stringify(o.statusList));o.ids.forEach((i,n)=>{const d=o.statusList.findIndex(D=>D.key===i);if(d!==-1){var c=r[d];c.order=n,t.push(c)}}),t.forEach((i,n)=>{const d=o.selectStatusList.findIndex(c=>i.value===c.value);d!==-1&&(t[n].canRead=o.selectStatusList[d].canRead,t[n].canWrite=o.selectStatusList[d].canWrite)}),o.selectStatusList=t,h()},O=s=>{console.log("start",s)},U=s=>{console.log("onEnd",s);for(let a=0;a<o.selectStatusList.length;a++){var e=o.selectStatusList[a];e.order=a,o.selectStatusList[a]=e}h()},h=()=>{console.log("selectStatusList",JSON.stringify(o.selectStatusList));var s=o.selectStatusList.map(e=>({statusId:e.value,canRead:e.canRead,canWrite:e.canWrite,order:e.order}));R("change",s)};return(s,e)=>{const a=B,t=A,r=M,i=F;return g(),S("div",tt,[u(r,null,{default:L(()=>[u(t,{span:22},{default:L(()=>[u(a,{modelValue:p(v),"onUpdate:modelValue":e[0]||(e[0]=n=>V(v)?v.value=n:null),data:p(k),"filter-method":W,titles:["Select All","Status"],"target-order":"push",filterable:"",onChange:N},null,8,["modelValue","data"])]),_:1})]),_:1}),et,st,p(f).length?(g(),S("div",at,[u(p(q),{ref_key:"dragRef",ref:w,modelValue:p(f),"onUpdate:modelValue":e[1]||(e[1]=n=>V(f)?f.value=n:null),"chosen-class":"chosen",onStart:O,onEnd:U},{default:L(()=>[(g(!0),S(G,null,H(p(f),(n,d)=>(g(),S("div",{key:d,class:"list-item-bg"},[l("div",ot,[l("div",nt,[l("div",rt,b(n.label),1),l("div",lt,[it,u(i,{modelValue:n.canRead,"onUpdate:modelValue":c=>n.canRead=c,onChange:h},null,8,["modelValue","onUpdate:modelValue"]),dt,ct,u(i,{modelValue:n.canWrite,"onUpdate:modelValue":c=>n.canWrite=c,onChange:h},null,8,["modelValue","onUpdate:modelValue"])])]),l("div",ut,b(n.order),1)])]))),128))]),_:1},8,["modelValue"])])):Q("",!0)])}}}),Ft=Z(pt,[["__scopeId","data-v-eeb7d595"]]);export{Ft as default};
