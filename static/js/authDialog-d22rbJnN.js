import{b as k,c as z,T as X,U as Y,V as Z,d as ee,N as oe}from"./element-plus-BsPKl9cL.js";import{S as te}from"./index-Tej3WPCJ.js";import{k as ae,_ as le}from"./index-DAJGaxl8.js";import{r as se}from"./role-YSLs6UZ9.js";import{I as ie}from"./@iconify-CPlIDRve.js";import{d as ne,r as ce,_ as de,$ as x,w as y,o as f,c as L,W as l,P as s,Q as re,a as r,V as _,u as a,l as C,U as p,O as N,T as pe}from"./@vue-Cr7qNLMI.js";import"./lodash-es-Blijzk1b.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-C4lJNpQw.js";import"./dayjs-C6J0yRL_.js";import"./@intlify-CHY6szXs.js";import"./@element-plus-BRXcaAil.js";import"./@ctrl-r5W6hzzQ.js";import"./@sxzz-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-uj-hNnAT.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CufQNpwK.js";import"./crypto-js-CYDAzdEe.js";import"./axios-B4uVmeYG.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-Dt-hUQlq.js";import"./vue-Dml5yltN.js";import"./nprogress-E-flP1tB.js";import"./mockjs-DOFpbtyb.js";import"./vite-plugin-mock-WFsnnzUG.js";import"./path-to-regexp-mDz3xsrU.js";const me={class:"bs-dialog"},ue={style:{margin:"-10px 0px 20px"}},ge={style:{padding:"0 5px 15px"}},fe={class:"tree-body"},_e={class:"bs-dialog-footer"},he=ne({__name:"authDialog",props:{isShow:{type:Boolean,default:!1},dialogData:{type:Object,default:()=>({})}},emits:["update:isShow","closed","success"],setup(T,{emit:I}){const h=I,v=T,n=ce(),e=de({dialogTitle:"权限设置",isShowDialog:!1,dialogSubmitBtnLoading:!1,dialogLoading:!1,roleData:{},menuTreeData:[],menuIdList:[],defaultProps:{label:"title",children:"children"},isExpandAll:!1,isSelectAll:!1,activeName:"first"}),{dialogTitle:A,isShowDialog:m,dialogSubmitBtnLoading:E,dialogLoading:V,roleData:B}=x(e),{menuTreeData:O,menuIdList:R,defaultProps:J,isExpandAll:D,isSelectAll:b,activeName:S}=x(e),w=t=>t&&t.includes(":"),P=t=>t&&!w(t);y(()=>v.isShow,t=>{e.isShowDialog=t}),y(()=>e.isShowDialog,t=>{h("update:isShow",t)}),y(()=>v.dialogData,t=>{e.roleData=JSON.parse(JSON.stringify(t))});const U=()=>{M()},K=()=>{h("closed",{})},M=()=>{const t={roleId:e.roleData.id};e.dialogLoading=!0,ae(t).then(o=>{e.dialogLoading=!1,o.code===2e4?(e.menuTreeData=o.data.menuTree,e.menuIdList=o.data.menuIds):k.warning(o.msg)}).catch(o=>{e.dialogLoading=!1,console.log(JSON.stringify(o))})},$=()=>{e.isExpandAll=!e.isExpandAll;const t=n.value.store._getAllNodes();for(var o=0;o<t.length;o++)t[o].expanded=e.isExpandAll},q=()=>{e.isSelectAll=!e.isSelectAll,e.isSelectAll?n.value.setCheckedNodes(e.menuTreeData):n.value.setCheckedNodes([])},F=()=>{H()},H=()=>{const t=e.roleData.id,o=n.value.getCheckedKeys(),c=n.value.getHalfCheckedKeys(),u={roleId:t,menuIds:o.concat(c)};console.log(JSON.stringify(u)),e.dialogSubmitBtnLoading=!0,se(u).then(d=>{e.dialogSubmitBtnLoading=!1,d.code===2e4?(k.success("角色设置权限成功!"),e.isShowDialog=!1,h("success",{})):k.warning(d.msg)}).catch(d=>{e.dialogSubmitBtnLoading=!1,console.log(JSON.stringify(d))})};return(t,o)=>{const c=z,u=te,d=X,j=Y,G=Z,Q=ee,W=oe;return f(),L("div",null,[l(Q,{title:a(A),modelValue:a(m),"onUpdate:modelValue":o[3]||(o[3]=i=>C(m)?m.value=i:null),top:"8vh",width:"55%","close-on-click-modal":!1,onOpened:U,onClosed:K},{default:s(()=>[re((f(),L("div",me,[r("div",ue,"选中角色："+_(a(B).name),1),l(G,{modelValue:a(S),"onUpdate:modelValue":o[0]||(o[0]=i=>C(S)?S.value=i:null),type:"card"},{default:s(()=>[l(j,{label:"菜单权限",name:"first"},{default:s(()=>[r("div",ge,[l(c,{type:"primary",icon:a(D)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:$},{default:s(()=>[p(_(a(D)?"全部收起":"全部展开"),1)]),_:1},8,["icon"]),l(c,{type:"primary",icon:a(b)?"i-ep-close":"i-ep-check",onClick:q},{default:s(()=>[p(_(a(b)?"全部取消":"全部选择"),1)]),_:1},8,["icon"])]),r("div",fe,[l(d,{ref_key:"treeRef",ref:n,data:a(O),"show-checkbox":"","check-on-click-node":!0,"node-key":"id","highlight-current":"","default-checked-keys":a(R),props:a(J)},{default:s(({node:i,data:g})=>[r("span",null,[w(g.icon)?(f(),N(a(ie),{key:0,icon:g.icon,class:"iconFont"},null,8,["icon"])):P(g.icon)?(f(),N(u,{key:1,"icon-class":g.icon,class:"iconFont"},null,8,["icon-class"])):pe("",!0),p(" "+_(i.label),1)])]),_:1},8,["data","default-checked-keys","props"])])]),_:1})]),_:1},8,["modelValue"]),r("div",_e,[l(c,{onClick:o[1]||(o[1]=i=>m.value=!1)},{default:s(()=>[p("取消")]),_:1}),l(c,{loading:a(E),type:"primary",onClick:o[2]||(o[2]=i=>F())},{default:s(()=>[p("保存")]),_:1},8,["loading"])])])),[[W,a(V)]])]),_:1},8,["title","modelValue"])])}}}),He=le(he,[["__scopeId","data-v-ab149506"]]);export{He as default};
