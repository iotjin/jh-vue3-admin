import{c as _,h as te,u as oe,v as ae,I as le,J as se,t as ne,w as ie,A as de,x as re,k as ce,K as me}from"./element-plus-aadc362a.js";import{o as p,c as Y,a as d,d as _e,r as pe,_ as ue,$ as V,w as K,i as ge,W as o,P as l,V as fe,u as n,k as L,U as b,Q as E,O as I,bh as he,bf as be}from"./@vue-e22e5611.js";import{s as we}from"./index-2ede00d3.js";import{a as ve}from"./user-e36aff2c.js";import{_ as De}from"./plugin-vueexport-helper-c27b6911.js";import"./lodash-es-d29772ce.js";import"./async-validator-dee29e8b.js";import"./@vueuse-1f405dae.js";import"./dayjs-78f57161.js";import"./@intlify-999e9484.js";import"./source-map-7d7e1c08.js";import"./@element-plus-db57e607.js";import"./@ctrl-f8748455.js";import"./@sxzz-c75af06c.js";import"./escape-html-bdfaebd7.js";import"./normalize-wheel-es-ed76fb12.js";import"./pinia-32912ef6.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-ff164504.js";import"./axios-4a70c6fc.js";import"./vue-i18n-01c42e63.js";import"./vue-f742e9c7.js";import"./js-cookie-edb2da2a.js";import"./nprogress-941844a1.js";import"./vite-plugin-mock-8bbc2346.js";import"./mockjs-3c670f17.js";import"./path-to-regexp-36ea9d8d.js";const Se={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ke=d("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512L340.864 831.872a30.592 30.592 0 0 0 0 42.752a29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1),Le=[Ke];function Ye(r,m){return p(),Y("svg",Se,Le)}const xe={name:"ep-arrow-right",render:Ye},Ce={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Re=d("path",{fill:"currentColor",d:"M609.408 149.376L277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0a30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688a29.12 29.12 0 0 0-41.728 0z"},null,-1),ye=[Re];function ke(r,m){return p(),Y("svg",Ce,ye)}const Be={name:"ep-arrow-left",render:ke};function $e(r){return we({url:"/v1/api/roles/byUserId",method:"get",params:r})}const x=r=>(he("data-v-ed1eb4a5"),r=r(),be(),r),Ve={class:"bs-dialog input-width"},Ee={style:{margin:"-10px 0px 20px"}},Ie=x(()=>d("div",{class:"role-title"},"可分配角色",-1)),Oe={class:"role-search"},Ne={class:"role-center"},Je=x(()=>d("br",null,null,-1)),Ue=x(()=>d("div",{class:"role-title"},"已分配角色",-1)),Te={class:"role-search"},ze={slot:"footer",class:"bs-dialog-footer",style:{"padding-top":"30px"}},Ae=_e({__name:"assignRoleDialog",props:{isShow:{type:Boolean,default:!1},dialogData:{type:Object,default:()=>({})}},emits:["update:isShow","closed","success"],setup(r,{emit:m}){const C=r;pe();const e=ue({dialogTitle:"分配角色",isShowDialog:!1,dialogSubmitBtnLoading:!1,userData:{},tableHeight:400,isLoadingK:!1,nameK:"",tableDataK:[],selectedRowsK:[],isLoadingY:!1,nameY:"",tableDataY:[],selectedRowsY:[]}),{dialogTitle:O,isShowDialog:u,dialogSubmitBtnLoading:N}=V(e),{userData:J,tableHeight:R,isLoadingK:U,nameK:w,tableDataK:T,isLoadingY:z,nameY:v,tableDataY:A}=V(e);K(()=>C.isShow,a=>{e.isShowDialog=a}),K(()=>e.isShowDialog,a=>{m("update:isShow",a)}),K(()=>C.dialogData,a=>{e.userData=JSON.parse(JSON.stringify(a))}),ge(()=>{});const M=()=>{g("K"),g("Y")},q=()=>{m("closed",{})},g=a=>{var t={userId:e.userData.id,name:"",status:""};t.name=a==="K"?e.nameK:e.nameY,t.status=a==="K"?"0":"1",console.log(JSON.stringify(t)),D(!0,a),$e(t).then(s=>{D(!1,a),s.code===2e4?a==="K"?e.tableDataK=s.data:e.tableDataY=s.data:_.error(s.msg)}).catch(s=>{D(!1,a),console.log(JSON.stringify(s))})},D=(a,t)=>{t==="K"?e.isLoadingK=a:e.isLoadingY=a},F=a=>{e.selectedRowsK=a},H=a=>{e.selectedRowsY=a},j=()=>{if(e.selectedRowsY.length===0){_.warning("请选择需要移除的已分配角色！");return}e.tableDataK=e.selectedRowsY.concat(e.tableDataK),e.tableDataY=e.tableDataY.filter(a=>!e.selectedRowsY.some(t=>a.id===t.id))},P=()=>{if(e.selectedRowsK.length===0){_.warning("请选择需要添加的可分配角色！");return}e.tableDataY=e.selectedRowsK.concat(e.tableDataY),e.tableDataK=e.tableDataK.filter(a=>!e.selectedRowsK.some(t=>a.id===t.id))},Q=()=>{W()},W=()=>{const a=e.tableDataY.map(s=>s.id),t={id:e.userData.id,roleIds:a};console.log(JSON.stringify(t)),e.dialogSubmitBtnLoading=!0,ve(t).then(s=>{e.dialogSubmitBtnLoading=!1,s.code===2e4?(_.success("分配角色成功!"),e.isShowDialog=!1,m("success",{})):_.error(s.msg)}).catch(s=>{e.dialogSubmitBtnLoading=!1,console.log(JSON.stringify(s))})};return(a,t)=>{const s=te,f=oe,h=ae,c=le,y=se,k=ne,S=ie,G=Be,B=de,X=xe,Z=re,ee=ce,$=me;return p(),Y("div",null,[o(ee,{title:n(O),modelValue:n(u),"onUpdate:modelValue":t[8]||(t[8]=i=>L(u)?u.value=i:null),top:"8vh",width:"60%","close-on-click-modal":!1,onOpened:M,onClosed:q},{default:l(()=>[d("div",Ve,[d("div",Ee,"选中用户："+fe(n(J).name),1),o(Z,{gutter:10,class:"dialog-body"},{default:l(()=>[o(S,{span:11},{default:l(()=>[Ie,o(k,{inline:!0,class:"role-left"},{default:l(()=>[d("div",Oe,[o(f,null,{default:l(()=>[o(s,{modelValue:n(w),"onUpdate:modelValue":t[0]||(t[0]=i=>L(w)?w.value=i:null),maxlength:"20",placeholder:"请输入角色名称",clearable:""},null,8,["modelValue"])]),_:1}),o(f,null,{default:l(()=>[o(h,{class:"bs-form-btn",type:"primary",onClick:t[1]||(t[1]=i=>g("K"))},{default:l(()=>[b("查询")]),_:1})]),_:1})]),E((p(),I(y,{data:n(T),"max-height":n(R),border:"",onSelectionChange:F},{default:l(()=>[o(c,{type:"selection"}),o(c,{prop:"name",label:"角色名称"}),o(c,{prop:"code",label:"角色编号"})]),_:1},8,["data","max-height"])),[[$,n(U)]])]),_:1})]),_:1}),o(S,{span:2},{default:l(()=>[d("div",Ne,[o(B,{size:22},{default:l(()=>[o(G,{onClick:t[2]||(t[2]=i=>j())})]),_:1}),Je,o(B,{size:22},{default:l(()=>[o(X,{onClick:t[3]||(t[3]=i=>P())})]),_:1})])]),_:1}),o(S,{span:11},{default:l(()=>[Ue,o(k,{inline:!0,class:"role-right"},{default:l(()=>[d("div",Te,[o(f,null,{default:l(()=>[o(s,{modelValue:n(v),"onUpdate:modelValue":t[4]||(t[4]=i=>L(v)?v.value=i:null),maxlength:"20",placeholder:"请输入角色名称",clearable:""},null,8,["modelValue"])]),_:1}),o(f,null,{default:l(()=>[o(h,{class:"bs-form-btn",type:"primary",onClick:t[5]||(t[5]=i=>g("Y"))},{default:l(()=>[b("查询")]),_:1})]),_:1})]),E((p(),I(y,{data:n(A),"max-height":n(R),border:"",onSelectionChange:H},{default:l(()=>[o(c,{type:"selection"}),o(c,{prop:"name",label:"角色名称"}),o(c,{prop:"code",label:"角色编号"})]),_:1},8,["data","max-height"])),[[$,n(z)]])]),_:1})]),_:1})]),_:1}),d("div",ze,[o(h,{onClick:t[6]||(t[6]=i=>u.value=!1)},{default:l(()=>[b("取消")]),_:1}),o(h,{loading:n(N),type:"primary",onClick:t[7]||(t[7]=i=>Q())},{default:l(()=>[b("保存")]),_:1},8,["loading"])])])]),_:1},8,["title","modelValue"])])}}});const ft=De(Ae,[["__scopeId","data-v-ed1eb4a5"]]);export{ft as default};
