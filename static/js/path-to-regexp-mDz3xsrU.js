function F(e){for(var n=[],t=0;t<e.length;){var r=e[t];if(r==="*"||r==="+"||r==="?"){n.push({type:"MODIFIER",index:t,value:e[t++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:t++,value:e[t++]});continue}if(r==="{"){n.push({type:"OPEN",index:t,value:e[t++]});continue}if(r==="}"){n.push({type:"CLOSE",index:t,value:e[t++]});continue}if(r===":"){for(var a="",i=t+1;i<e.length;){var c=e.charCodeAt(i);if(c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||c===95){a+=e[i++];continue}break}if(!a)throw new TypeError("Missing parameter name at ".concat(t));n.push({type:"NAME",index:t,value:a}),t=i;continue}if(r==="("){var u=1,f="",i=t+1;if(e[i]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(i));for(;i<e.length;){if(e[i]==="\\"){f+=e[i++]+e[i++];continue}if(e[i]===")"){if(u--,u===0){i++;break}}else if(e[i]==="("&&(u++,e[i+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(i));f+=e[i++]}if(u)throw new TypeError("Unbalanced pattern at ".concat(t));if(!f)throw new TypeError("Missing pattern at ".concat(t));n.push({type:"PATTERN",index:t,value:f}),t=i;continue}n.push({type:"CHAR",index:t,value:e[t++]})}return n.push({type:"END",index:t,value:""}),n}function L(e,n){n===void 0&&(n={});for(var t=F(e),r=n.prefixes,a=r===void 0?"./":r,i="[^".concat(C(n.delimiter||"/#?"),"]+?"),c=[],u=0,f=0,o="",s=function(g){if(f<t.length&&t[f].type===g)return t[f++].value},p=function(g){var T=s(g);if(T!==void 0)return T;var $=t[f],M=$.type,O=$.index;throw new TypeError("Unexpected ".concat(M," at ").concat(O,", expected ").concat(g))},l=function(){for(var g="",T;T=s("CHAR")||s("ESCAPED_CHAR");)g+=T;return g};f<t.length;){var y=s("CHAR"),x=s("NAME"),h=s("PATTERN");if(x||h){var v=y||"";a.indexOf(v)===-1&&(o+=v,v=""),o&&(c.push(o),o=""),c.push({name:x||u++,prefix:v,suffix:"",pattern:h||i,modifier:s("MODIFIER")||""});continue}var m=y||s("ESCAPED_CHAR");if(m){o+=m;continue}o&&(c.push(o),o="");var A=s("OPEN");if(A){var v=l(),N=s("NAME")||"",d=s("PATTERN")||"",w=l();p("CLOSE"),c.push({name:N||(d?u++:""),pattern:N&&!d?i:d,prefix:v,suffix:w,modifier:s("MODIFIER")||""});continue}p("END")}return c}function C(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function S(e){return e&&e.sensitive?"":"i"}function W(e,n){return e}function j(e,n,t){var r=e.map(function(a){return J(a,n,t).source});return new RegExp("(?:".concat(r.join("|"),")"),S(t))}function K(e,n,t){return V(L(e,t),n,t)}function V(e,n,t){t===void 0&&(t={});for(var r=t.strict,a=r===void 0?!1:r,i=t.start,c=i===void 0?!0:i,u=t.end,f=u===void 0?!0:u,o=t.encode,s=o===void 0?function(O){return O}:o,p=t.delimiter,l=p===void 0?"/#?":p,y=t.endsWith,x=y===void 0?"":y,h="[".concat(C(x),"]|$"),v="[".concat(C(l),"]"),m=c?"^":"",A=0,N=e;A<N.length;A++){var d=N[A];if(typeof d=="string")m+=C(s(d));else{var w=C(s(d.prefix)),g=C(s(d.suffix));if(d.pattern)if(w||g)if(d.modifier==="+"||d.modifier==="*"){var T=d.modifier==="*"?"?":"";m+="(?:".concat(w,"((?:").concat(d.pattern,")(?:").concat(g).concat(w,"(?:").concat(d.pattern,"))*)").concat(g,")").concat(T)}else m+="(?:".concat(w,"(").concat(d.pattern,")").concat(g,")").concat(d.modifier);else d.modifier==="+"||d.modifier==="*"?m+="((?:".concat(d.pattern,")").concat(d.modifier,")"):m+="(".concat(d.pattern,")").concat(d.modifier);else m+="(?:".concat(w).concat(g,")").concat(d.modifier)}}if(f)a||(m+="".concat(v,"?")),m+=t.endsWith?"(?=".concat(h,")"):"$";else{var $=e[e.length-1],M=typeof $=="string"?v.indexOf($[$.length-1])>-1:$===void 0;a||(m+="(?:".concat(v,"(?=").concat(h,"))?")),M||(m+="(?=".concat(v,"|").concat(h,")"))}return new RegExp(m,S(t))}function J(e,n,t){return e instanceof RegExp?W(e):Array.isArray(e)?j(e,n,t):K(e,n,t)}var E={};Object.defineProperty(E,"__esModule",{value:!0});E.pathToRegexp=E.match=Y=E.compile=E.parse=E.TokenData=void 0;const X="/",b=e=>e,q=new RegExp("^\\p{XID_Continue}$","u"),z={"!":"!","@":"@",";":";",",":",","*":"*","+":"+","?":"?","{":"{","}":"}"};function B(e){const n=[...e],t=[];let r=0;for(;r<n.length;){const a=n[r],i=z[a];if(i){t.push({type:i,index:r++,value:a});continue}if(a==="\\"){t.push({type:"ESCAPED",index:r++,value:n[r++]});continue}if(a===":"){let c="";for(;q.test(n[++r]);)c+=n[r];if(!c)throw new TypeError(`Missing parameter name at ${r}`);t.push({type:"NAME",index:r,value:c});continue}if(a==="("){const c=r++;let u=1,f="";if(n[r]==="?")throw new TypeError(`Pattern cannot start with "?" at ${r}`);for(;r<n.length;){if(n[r]==="\\"){f+=n[r++]+n[r++];continue}if(n[r]===")"){if(u--,u===0){r++;break}}else if(n[r]==="("&&(u++,n[r+1]!=="?"))throw new TypeError(`Capturing groups are not allowed at ${r}`);f+=n[r++]}if(u)throw new TypeError(`Unbalanced pattern at ${c}`);if(!f)throw new TypeError(`Missing pattern at ${c}`);t.push({type:"PATTERN",index:r,value:f});continue}t.push({type:"CHAR",index:r,value:n[r++]})}return t.push({type:"END",index:r,value:""}),new G(t)}class G{constructor(n){this.tokens=n,this.index=0}peek(){return this.tokens[this.index]}tryConsume(n){const t=this.peek();if(t.type===n)return this.index++,t.value}consume(n){const t=this.tryConsume(n);if(t!==void 0)return t;const{type:r,index:a}=this.peek();throw new TypeError(`Unexpected ${r} at ${a}, expected ${n}: https://git.new/pathToRegexpError`)}text(){let n="",t;for(;t=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)n+=t;return n}modifier(){return this.tryConsume("?")||this.tryConsume("*")||this.tryConsume("+")||""}}class P{constructor(n,t){this.tokens=n,this.delimiter=t}}E.TokenData=P;function D(e,n={}){const{delimiter:t=X,encodePath:r=b}=n,a=[],i=B(e);let c=0;do{const u=i.text();u&&a.push(r(u));const f=i.tryConsume("NAME"),o=i.tryConsume("PATTERN");if(f||o){a.push({name:f||String(c++),pattern:o});const l=i.peek();if(l.type==="*")throw new TypeError(`Unexpected * at ${l.index}, you probably want \`/*\` or \`{/:foo}*\`: https://git.new/pathToRegexpError`);continue}if(i.tryConsume("*")){a.push({name:String(c++),pattern:`[^${R(t)}]*`,modifier:"*",separator:t});continue}if(i.tryConsume("{")){const l=i.text(),y=i.tryConsume("NAME"),x=i.tryConsume("PATTERN"),h=i.text(),v=i.tryConsume(";")?i.text():l+h;i.consume("}");const m=i.modifier();a.push({name:y||(x?String(c++):""),prefix:r(l),suffix:r(h),pattern:x,modifier:m,separator:v});continue}i.consume("END");break}while(!0);return new P(a,t)}E.parse=D;function Q(e,n={}){const t=e instanceof P?e:D(e,n);return k(t,n)}var Y=E.compile=Q;function Z(e,n){if(typeof e=="string")return()=>e;const t=n||b,r=e.modifier==="+"||e.modifier==="*",a=e.modifier==="?"||e.modifier==="*",{prefix:i="",suffix:c="",separator:u=""}=e;if(n&&r){const o=(p,l)=>{if(typeof p!="string")throw new TypeError(`Expected "${e.name}/${l}" to be a string`);return t(p)},s=p=>{if(!Array.isArray(p))throw new TypeError(`Expected "${e.name}" to be an array`);return p.length===0?"":i+p.map(o).join(u)+c};return a?p=>{const l=p[e.name];return l==null?"":l.length?s(l):""}:p=>{const l=p[e.name];return s(l)}}const f=o=>{if(typeof o!="string")throw new TypeError(`Expected "${e.name}" to be a string`);return i+t(o)+c};return a?o=>{const s=o[e.name];return s==null?"":f(s)}:o=>{const s=o[e.name];return f(s)}}function k(e,n){const{encode:t=encodeURIComponent,loose:r=!0,validate:a=!0}=n,i=_(n),c=I(r,e.delimiter),u=U(c,e.delimiter),f=e.tokens.map(o=>{const s=Z(o,t);if(!a||typeof o=="string")return s;const p=u(o),l=new RegExp(`^${p}$`,i);return y=>{const x=s(y);if(!l.test(x))throw new TypeError(`Invalid value for "${o.name}": ${JSON.stringify(x)}`);return x}});return function(s={}){let p="";for(const l of f)p+=l(s);return p}}function ee(e,n={}){const{decode:t=decodeURIComponent,loose:r=!0}=n,a=e instanceof P?e:D(e,n),i=I(r,a.delimiter),c=[],u=H(a,c,n),f=c.map(o=>{if(t&&(o.modifier==="+"||o.modifier==="*")){const s=new RegExp(i(o.separator||""),"g");return p=>p.split(s).map(t)}return t||b});return function(s){const p=u.exec(s);if(!p)return!1;const{0:l,index:y}=p,x=Object.create(null);for(let h=1;h<p.length;h++){if(p[h]===void 0)continue;const v=c[h-1],m=f[h-1];x[v.name]=m(p[h])}return{path:l,index:y,params:x}}}E.match=ee;function R(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function te(e,n){return n?`${R(e)}+`:R(e)}function I(e,n){if(!e)return R;const t=new RegExp(`[^${R(n)}]+|(.)`,"g");return r=>r.replace(t,te)}function _(e){return e.sensitive?"":"i"}function H(e,n,t){const{trailing:r=!0,start:a=!0,end:i=!0,loose:c=!0}=t,u=I(c,e.delimiter),f=U(u,e.delimiter);let o=a?"^":"";for(const s of e.tokens)typeof s=="string"?o+=u(s):(s.name&&n.push(s),o+=f(s));return r&&(o+=`(?:${u(e.delimiter)})?`),o+=i?"$":`(?=${R(e.delimiter)}|$)`,new RegExp(o,_(t))}function U(e,n){const t=`[^${R(n)}]+?`;return r=>{const a=r.prefix?e(r.prefix):"",i=r.suffix?e(r.suffix):"",c=r.modifier||"";if(r.name){const u=r.pattern||t;if(r.modifier==="+"||r.modifier==="*"){const f=r.modifier==="*"?"?":"",o=r.separator?e(r.separator):"";return`(?:${a}((?:${u})(?:${o}(?:${u}))*)${i})${f}`}return`(?:${a}(${u})${i})${c}`}return`(?:${a}${i})${c}`}}function ne(e,n={}){const t=e instanceof P?e:D(e,n),r=[],a=H(t,r,n);return Object.assign(a,{keys:r})}E.pathToRegexp=ne;export{Y as c,J as p};
