import{c as k,b as ne,h as ie,u as se,v as de,t as re,H as ce,I as pe,J as me}from"./element-plus-29f174c0.js";import{S as ue}from"./index-24a8e899.js";import{d as ge,r as fe,$ as C,a0 as T,i as _e,ao as be,o as u,c as he,X as a,Q as s,u as l,af as J,V as g,a as m,R as f,P as _,W as x,U as ye,S as we,l as xe,bh as ve,bf as Se}from"./@vue-7d0fc2b4.js";import{e as De,f as ke}from"./index-3358e511.js";import{d as Ce,A as Te}from"./addDialog-8153747b.js";import{I as Ee}from"./@iconify-5142df58.js";import{_ as Ie}from"./plugin-vueexport-helper-c27b6911.js";import"./lodash-es-d29772ce.js";import"./async-validator-dee29e8b.js";import"./@vueuse-d1e6df39.js";import"./dayjs-78f57161.js";import"./@intlify-999e9484.js";import"./source-map-7d7e1c08.js";import"./@element-plus-975622b8.js";import"./@ctrl-f8748455.js";import"./@sxzz-c75af06c.js";import"./escape-html-bdfaebd7.js";import"./normalize-wheel-es-ed76fb12.js";import"./pinia-4649f5ad.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-98b533fa.js";import"./axios-4a70c6fc.js";import"./vue-i18n-625cf0a6.js";import"./vue-ff9293da.js";import"./js-cookie-edb2da2a.js";import"./nprogress-941844a1.js";import"./mockjs-3c670f17.js";import"./vite-plugin-mock-8bbc2346.js";import"./path-to-regexp-36ea9d8d.js";import"./select-tree-b7667588.js";const L=w=>(ve("data-v-9caf665a"),w=w(),Se(),w),Re={class:"bs-page-body"},Ae=L(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单名称:")],-1)),Ne=L(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单编码:")],-1)),Ve={class:"bs-page-table"},Oe={class:"bs-table-btns"},Je=["onClick"],Le={style:{color:"#00a0e9","text-decoration":"underline"}},Fe=ge({__name:"index",setup(w){const v=fe(),n=C({tableLoading:!1,tableData:[],queryParams:{title:"",code:""},selectedRows:[],isExpandAll:!1,treeProps:{children:"children",hasChildren:"hasChildren"}}),{tableLoading:F,tableData:B,queryParams:y,selectedRows:S,isExpandAll:E,treeProps:P}=T(n),M=C({menuTypeOptions:Ce}),{menuTypeOptions:q}=T(M),d=C({isShowDialog:!1,dialogType:"",dialogFormData:{},dialogTreeData:[]}),{isShowDialog:D,dialogType:K,dialogFormData:$,dialogTreeData:U}=T(d),I=e=>e&&e.includes(":"),z=e=>e&&!I(e);_e(()=>{b()});const b=()=>{var e=JSON.parse(JSON.stringify(n.queryParams));console.log(JSON.stringify(e)),n.tableLoading=!0,De(e).then(t=>{n.tableLoading=!1,t.code===2e4?n.tableData=t.data:k.warning(t.msg)}).catch(t=>{n.tableLoading=!1,console.log(JSON.stringify(t))})},j=({row:e,column:t,rowIndex:i,columnIndex:c})=>t.label==="菜单名称"?{textAlign:"left",paddingLeft:"10px"}:{textAlign:"center"},G=({row:e,column:t,rowIndex:i,columnIndex:c})=>({textAlign:t.label==="菜单名称"?"left":"center"}),H=e=>"b-tag b-tag-"+e.menuType,Q=e=>{n.selectedRows=e},W=(e,t)=>{const i=t.findIndex(c=>c.value===e);if(i!==-1)return t[i].label},X=()=>{d.dialogType="add",d.dialogFormData={},d.dialogTreeData=n.tableData,d.isShowDialog=!0},R=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="edit",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},A=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="look",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},N=e=>{var t="";e&&e.id?t=e.title:t=n.selectedRows.map(i=>i.title).join(","),ne.confirm(`确定要删除菜单 ${t} （如果包含子菜单，将一并删除），此操作将永久删除, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var i={ids:[]};if(e&&e.id)i.ids=[e.id];else{const c=n.selectedRows.map(r=>r.id);i.ids=c}Y(i)})},Y=e=>{console.log(JSON.stringify(e)),ke(e).then(t=>{t.code===2e4?(k.success("删除成功!"),b()):k.warning(t.msg)})},Z=()=>{n.isExpandAll=!n.isExpandAll,V(n.tableData,n.isExpandAll)},V=(e,t)=>{e.forEach(i=>{v.value.toggleRowExpansion(i,t),i.children!==void 0&&i.children!==null&&V(i.children,t)})},ee=()=>{v.value.clearSelection()};return(e,t)=>{const i=ie,c=se,r=de,te=re,p=ce,oe=ue,ae=pe,h=be("hasPerm"),le=me;return u(),he("div",Re,[a(te,{inline:!0,model:l(y),class:"bs-form-search mt10"},{default:s(()=>[a(c,null,{default:s(()=>[Ae,a(i,{modelValue:l(y).title,"onUpdate:modelValue":t[0]||(t[0]=o=>l(y).title=o),maxlength:"20",placeholder:"请输入菜单名称",clearable:"",onKeyup:J(b,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),a(c,null,{default:s(()=>[Ne,a(i,{modelValue:l(y).code,"onUpdate:modelValue":t[1]||(t[1]=o=>l(y).code=o),maxlength:"20",placeholder:"请输入菜单编码",clearable:"",onKeyup:J(b,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),a(c,null,{default:s(()=>[a(r,{class:"bs-form-btn",type:"primary",onClick:b},{default:s(()=>[g("查询")]),_:1})]),_:1})]),_:1},8,["model"]),m("div",Ve,[m("div",Oe,[f((u(),_(r,{type:"primary",icon:"i-ep-plus",onClick:X},{default:s(()=>[g(" 新增 ")]),_:1})),[[h,["menu-add"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-edit",disabled:l(S).length!==1,onClick:R},{default:s(()=>[g(" 编辑 ")]),_:1},8,["disabled"])),[[h,["menu-edit"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-search",disabled:l(S).length!==1,onClick:A},{default:s(()=>[g(" 查看 ")]),_:1},8,["disabled"])),[[h,["menu-look"]]]),f((u(),_(r,{type:"danger",icon:"i-ep-delete",disabled:l(S).length!==1,onClick:N},{default:s(()=>[g(" 删除 ")]),_:1},8,["disabled"])),[[h,["menu-delete"]]]),a(r,{plain:"",icon:l(E)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:Z},{default:s(()=>[g(x(l(E)?"全部收起":"全部展开"),1)]),_:1},8,["icon"])]),f((u(),_(ae,{ref_key:"tableRef",ref:v,class:"bs-table",data:l(B),"tree-props":l(P),"row-key":"id","default-expand-all":!1,stripe:!0,"header-cell-style":j,"cell-style":G,onSelectionChange:Q},{default:s(()=>[a(p,{type:"selection",width:"55px"}),a(p,{label:"菜单名称","min-width":"200px"},{default:s(o=>[m("span",{onClick:O=>A(o.row)},[m("a",Le,[I(o.row.icon)?(u(),_(l(Ee),{key:0,icon:o.row.icon,class:"iconFont"},null,8,["icon"])):z(o.row.icon)?(u(),_(oe,{key:1,"icon-class":o.row.icon,class:"iconFont"},null,8,["icon-class"])):ye("",!0),g(" "+x(o.row.title),1)])],8,Je)]),_:1}),a(p,{label:"菜单类型","min-width":"100"},{default:s(o=>[m("div",{class:we(H(o.row))},x(W(o.row.menuType,l(q))),3)]),_:1}),a(p,{prop:"code",label:"菜单编码","min-width":"170px"}),a(p,{prop:"sort",label:"排序"}),a(p,{label:"可见"},{default:s(o=>[g(x(o.row.menuType==="button"?"":o.row.hidden?"隐藏":"显示"),1)]),_:1}),a(p,{prop:"component",label:"组件路径","min-width":"220px"}),a(p,{prop:"parentTitle",label:"上级菜单"}),a(p,{fixed:"right",label:"操作",width:"120"},{default:s(o=>[f(a(r,{size:"small",icon:"i-ep-edit",onClick:O=>R(o.row)},null,8,["onClick"]),[[h,["menu-edit"]]]),f(a(r,{size:"small",icon:"i-ep-delete",type:"danger",onClick:O=>N(o.row)},null,8,["onClick"]),[[h,["menu-delete"]]])]),_:1})]),_:1},8,["data","tree-props"])),[[le,l(F)]])]),a(Te,{"dialog-type":l(K),"is-show":l(D),"onUpdate:isShow":t[2]||(t[2]=o=>xe(D)?D.value=o:null),"dialog-data":l($),"dialog-tree-data":l(U),onSuccess:b,onClosed:ee},null,8,["dialog-type","is-show","dialog-data","dialog-tree-data"])])}}});const gt=Ie(Fe,[["__scopeId","data-v-9caf665a"]]);export{gt as default};
