import{b as D,a as ne,k as ie,w as se,c as de,v as re,P as ce,Q as pe,R as me}from"./element-plus-C1_tH_9n.js";import{n as ue,o as ge,S as fe,_ as _e}from"./index-B8W-cxH9.js";import{d as be,r as he,_ as C,$ as T,f as ye,am as we,o as u,c as xe,W as a,P as s,u as l,ae as L,U as g,a as m,Q as f,O as _,V as x,T as Se,R as ke,l as ve,bm as De,bk as Ce}from"./@vue-ROmf2CMa.js";import{d as Te,A as Ee}from"./addDialog-B-4KwMm2.js";import{I as Ie}from"./@iconify-BpbYFE0g.js";import"./lodash-es-Blijzk1b.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-Cv4Wji3s.js";import"./dayjs-C6J0yRL_.js";import"./@intlify-CHY6szXs.js";import"./@element-plus-Ds9axIkZ.js";import"./@ctrl-r5W6hzzQ.js";import"./@sxzz-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-CNAM5qpy.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CP6FQFzT.js";import"./crypto-js-CYDAzdEe.js";import"./axios-mH-cpkvd.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-BHOT87Ho.js";import"./vue-DoOO_nKc.js";import"./nprogress-E-flP1tB.js";import"./mockjs-DOFpbtyb.js";import"./vite-plugin-mock-B2SH9_m9.js";import"./path-to-regexp-Cdn6gXUT.js";import"./select-tree-Dbk2syLX.js";const F=w=>(De("data-v-9caf665a"),w=w(),Ce(),w),Re={class:"bs-page-body"},Ae=F(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单名称:")],-1)),Ne=F(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单编码:")],-1)),Oe={class:"bs-page-table"},Ve={class:"bs-table-btns"},Le=["onClick"],Fe={style:{color:"#00a0e9","text-decoration":"underline"}},Je=be({__name:"index",setup(w){const S=he(),n=C({tableLoading:!1,tableData:[],queryParams:{title:"",code:""},selectedRows:[],isExpandAll:!1,treeProps:{children:"children",hasChildren:"hasChildren"}}),{tableLoading:J,tableData:P,queryParams:y,selectedRows:k,isExpandAll:E,treeProps:B}=T(n),M=C({menuTypeOptions:Te}),{menuTypeOptions:q}=T(M),d=C({isShowDialog:!1,dialogType:"",dialogFormData:{},dialogTreeData:[]}),{isShowDialog:v,dialogType:$,dialogFormData:U,dialogTreeData:z}=T(d),I=e=>e&&e.includes(":"),K=e=>e&&!I(e);ye(()=>{b()});const b=()=>{var e=JSON.parse(JSON.stringify(n.queryParams));console.log(JSON.stringify(e)),n.tableLoading=!0,ue(e).then(t=>{n.tableLoading=!1,t.code===2e4?n.tableData=t.data:D.warning(t.msg)}).catch(t=>{n.tableLoading=!1,console.log(JSON.stringify(t))})},Q=({row:e,column:t,rowIndex:i,columnIndex:c})=>t.label==="菜单名称"?{textAlign:"left",paddingLeft:"10px"}:{textAlign:"center"},j=({row:e,column:t,rowIndex:i,columnIndex:c})=>({textAlign:t.label==="菜单名称"?"left":"center"}),G=e=>"b-tag b-tag-"+e.menuType,W=e=>{n.selectedRows=e},H=(e,t)=>{const i=t.findIndex(c=>c.value===e);if(i!==-1)return t[i].label},X=()=>{d.dialogType="add",d.dialogFormData={},d.dialogTreeData=n.tableData,d.isShowDialog=!0},R=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="edit",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},A=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="look",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},N=e=>{var t="";e&&e.id?t=e.title:t=n.selectedRows.map(i=>i.title).join(","),ne.confirm(`确定要删除菜单 ${t} （如果包含子菜单，将一并删除），此操作将永久删除, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var i={ids:[]};if(e&&e.id)i.ids=[e.id];else{const c=n.selectedRows.map(r=>r.id);i.ids=c}Y(i)})},Y=e=>{console.log(JSON.stringify(e)),ge(e).then(t=>{t.code===2e4?(D.success("删除成功!"),b()):D.warning(t.msg)})},Z=()=>{n.isExpandAll=!n.isExpandAll,O(n.tableData,n.isExpandAll)},O=(e,t)=>{e.forEach(i=>{S.value.toggleRowExpansion(i,t),i.children!==void 0&&i.children!==null&&O(i.children,t)})},ee=()=>{S.value.clearSelection()};return(e,t)=>{const i=ie,c=se,r=de,te=re,p=ce,oe=fe,ae=pe,h=we("hasPerm"),le=me;return u(),xe("div",Re,[a(te,{inline:!0,model:l(y),class:"bs-form-search mt10"},{default:s(()=>[a(c,null,{default:s(()=>[Ae,a(i,{modelValue:l(y).title,"onUpdate:modelValue":t[0]||(t[0]=o=>l(y).title=o),maxlength:"20",placeholder:"请输入菜单名称",clearable:"",onKeyup:L(b,["enter","native"])},null,8,["modelValue"])]),_:1}),a(c,null,{default:s(()=>[Ne,a(i,{modelValue:l(y).code,"onUpdate:modelValue":t[1]||(t[1]=o=>l(y).code=o),maxlength:"20",placeholder:"请输入菜单编码",clearable:"",onKeyup:L(b,["enter","native"])},null,8,["modelValue"])]),_:1}),a(c,null,{default:s(()=>[a(r,{class:"bs-form-btn",type:"primary",onClick:b},{default:s(()=>[g("查询")]),_:1})]),_:1})]),_:1},8,["model"]),m("div",Oe,[m("div",Ve,[f((u(),_(r,{type:"primary",icon:"i-ep-plus",onClick:X},{default:s(()=>[g(" 新增 ")]),_:1})),[[h,["menu-add"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-edit",disabled:l(k).length!==1,onClick:R},{default:s(()=>[g(" 编辑 ")]),_:1},8,["disabled"])),[[h,["menu-edit"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-search",disabled:l(k).length!==1,onClick:A},{default:s(()=>[g(" 查看 ")]),_:1},8,["disabled"])),[[h,["menu-look"]]]),f((u(),_(r,{type:"danger",icon:"i-ep-delete",disabled:l(k).length!==1,onClick:N},{default:s(()=>[g(" 删除 ")]),_:1},8,["disabled"])),[[h,["menu-delete"]]]),a(r,{plain:"",icon:l(E)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:Z},{default:s(()=>[g(x(l(E)?"全部收起":"全部展开"),1)]),_:1},8,["icon"])]),f((u(),_(ae,{ref_key:"tableRef",ref:S,class:"bs-table",data:l(P),"tree-props":l(B),"row-key":"id","default-expand-all":!1,stripe:!0,"header-cell-style":Q,"cell-style":j,onSelectionChange:W},{default:s(()=>[a(p,{type:"selection",width:"55px"}),a(p,{label:"菜单名称","min-width":"200px"},{default:s(o=>[m("span",{onClick:V=>A(o.row)},[m("a",Fe,[I(o.row.icon)?(u(),_(l(Ie),{key:0,icon:o.row.icon,class:"iconFont"},null,8,["icon"])):K(o.row.icon)?(u(),_(oe,{key:1,"icon-class":o.row.icon,class:"iconFont"},null,8,["icon-class"])):Se("",!0),g(" "+x(o.row.title),1)])],8,Le)]),_:1}),a(p,{label:"菜单类型","min-width":"100"},{default:s(o=>[m("div",{class:ke(G(o.row))},x(H(o.row.menuType,l(q))),3)]),_:1}),a(p,{prop:"code",label:"菜单编码","min-width":"170px"}),a(p,{prop:"sort",label:"排序"}),a(p,{label:"可见"},{default:s(o=>[g(x(o.row.menuType==="button"?"":o.row.hidden?"隐藏":"显示"),1)]),_:1}),a(p,{prop:"component",label:"组件路径","min-width":"220px"}),a(p,{prop:"parentTitle",label:"上级菜单"}),a(p,{fixed:"right",label:"操作",width:"120"},{default:s(o=>[f(a(r,{size:"small",icon:"i-ep-edit",onClick:V=>R(o.row)},null,8,["onClick"]),[[h,["menu-edit"]]]),f(a(r,{size:"small",icon:"i-ep-delete",type:"danger",onClick:V=>N(o.row)},null,8,["onClick"]),[[h,["menu-delete"]]])]),_:1})]),_:1},8,["data","tree-props"])),[[le,l(J)]])]),a(Ee,{"dialog-type":l($),"is-show":l(v),"onUpdate:isShow":t[2]||(t[2]=o=>ve(v)?v.value=o:null),"dialog-data":l(U),"dialog-tree-data":l(z),onSuccess:b,onClosed:ee},null,8,["dialog-type","is-show","dialog-data","dialog-tree-data"])])}}}),pt=_e(Je,[["__scopeId","data-v-9caf665a"]]);export{pt as default};
