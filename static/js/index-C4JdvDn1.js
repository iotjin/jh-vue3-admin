import{b as C,w as Re,k as Oe,J as Te,K as Ne,L as Pe,c as Ee,v as Je,D as Ue,F as Le,j as Ve,G as Ye,a as Be}from"./element-plus-BTXRAC_-.js";import{_ as Fe}from"./index-ZlgNM_hh.js";import{d as Ae,r as W,_ as x,$ as R,i as Me,c as X,o as O,a as d,W as l,P as s,af as Ie,u as o,F as $e,ab as qe,O as H,l as D,U as m,Q as Z,V as _,a1 as ze,R as Ke,X as je,bm as Ge,bk as Qe,n as We}from"./@vue-KIsu0X2L.js";import{g as Xe,a as ee,d as He}from"./tables-IFlmwdDV.js";import Ze from"./addDialog-Kc01_pLs.js";import et from"./selectDialog-BG4ON6Nl.js";import tt from"./addProductDialog-CYA7QR0U.js";import{_ as at}from"./dragSortDialog.vuevuetypescriptsetuptruelang-CW8E7RLg.js";import{T}from"./timeUtils-CwNtu00v.js";import{e as lt}from"./exportExcel-Bsxx560a.js";import{_ as ot}from"./index-eLds9Yb_.js";import"./lodash-es-gvlvjXa_.js";import"./async-validator-9PlIezaS.js";import"./@vueuse-D4qJsfSX.js";import"./dayjs-CIy0qJcO.js";import"./@intlify-CLUpp_Iz.js";import"./@sxzz-D_chPuIy.js";import"./@element-plus-BQ5DqatN.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./dict-D2y79XyQ.js";import"./base-BcGN4cv5.js";import"./user-BhnO8SSB.js";import"./checkUtils-D9STjg8r.js";import"./setStatus-Afu4wRgy.js";import"./vue-draggable-plus-DB7mI_zb.js";import"./xlsx-DrgRuPKf.js";import"./pinia-B7D0yCDv.js";import"./vue-router-Zv4ZtmtT.js";import"./crypto-js-DkIsdnw7.js";import"./axios-Br0q4W-C.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-CSWdtZJ9.js";import"./vue-tv3Mw8Sw.js";import"./nprogress-5SZ_0UJX.js";import"./mockjs-CidrXOpc.js";import"./vite-plugin-mock-Ckf4sHq3.js";import"./path-to-regexp-BzK_ZY7n.js";const h=w=>(Ge("data-v-6e09690d"),w=w(),Qe(),w),st={class:"bs-page-body"},it=h(()=>d("span",{class:"bs-form-label",style:{width:"80px"}},[d("span",{class:"icon"},"姓名:")],-1)),nt=h(()=>d("span",{class:"bs-form-label",style:{width:"80px"}},[d("span",{class:"icon"},"级别:")],-1)),dt=h(()=>d("span",{class:"bs-form-label",style:{width:"100px"}},[d("span",{class:"icon"},"创建时间:")],-1)),rt={class:"bs-page-table"},pt={class:"bs-table-btns"},ct={class:"date-picker-bg"},mt={style:{"margin-left":"15px"}},ut=["onClick"],gt={style:{color:"#00a0e9","text-decoration":"underline"}},ft=h(()=>d("div",null,"启用",-1)),_t=h(()=>d("div",null,"状态",-1)),bt={class:"bs-tooltip-text"},Dt=Ae({__name:"index",setup(w){const B=W(),F=W(),i=x({tableTotal:0,tableLoading:!1,tableData:[],queryParams:{page:1,limit:10,startDate:"",endDate:"",name:"",level:""},dateRange:[],selectedRows:[],cellBtnLoading:""}),{tableTotal:A,tableLoading:te,tableData:ae,queryParams:g,dateRange:N,selectedRows:P,cellBtnLoading:le}=R(i),y=x({deptOptions:[],levelOptions:[]}),{deptOptions:ht,levelOptions:M}=R(y),n=x({isShowDialog:!1,dialogType:"add",dialogFormData:{},isShowSelectDialog:!1,dialogData2:{},isShowAddProductDialog:!1,isRefreshDialog:!1,isShowDragDialog:!1}),{isShowDialog:E,dialogType:oe,dialogFormData:I,isShowSelectDialog:J,dialogData2:se,isShowAddProductDialog:U,isRefreshDialog:ie,isShowDragDialog:L}=R(n),ne=x({pickerOptions:{disabledDate(e){return e.getTime()<Date.now()}},date:""}),{pickerOptions:de,date:S}=R(ne);Me(()=>{re(),b()});const re=()=>{Xe().then(e=>{e.code===2e4?y.levelOptions=e.data:C.warning(e.msg)})},b=()=>{var e=JSON.parse(JSON.stringify(i.queryParams));e.startDate=i.dateRange?T.startOfDay(i.dateRange[0]):"",e.endDate=i.dateRange?T.endOfDay(i.dateRange[1]):"",console.log(JSON.stringify(e)),i.tableLoading=!0,ee(e).then(a=>{i.tableLoading=!1,a.code===2e4?(i.tableData=a.data,i.tableTotal=a.total):C.warning(a.msg)}).catch(a=>{i.tableLoading=!1,console.log(JSON.stringify(a))})},$=()=>{i.queryParams.page=1,b()},V=e=>!0,pe=e=>{i.selectedRows=e},Y=(e,a)=>{const c=a.findIndex(f=>f.value===e);if(c!==-1)return a[c].label},ce=e=>e.status==="0"?"#E6A23C":"#67C23A",me=()=>{n.dialogType="add",n.dialogFormData={},n.isShowDialog=!0},q=e=>{const a=JSON.parse(JSON.stringify(e&&e.id?e:i.selectedRows[0]));n.dialogType="edit",n.dialogFormData=a,n.isShowDialog=!0},ue=e=>{const a=JSON.parse(JSON.stringify(e&&e.id?e:i.selectedRows[0]));n.dialogType="look",n.dialogFormData=a,n.isShowDialog=!0},z=e=>{var a="";e&&e.id?a=e.name:a=i.selectedRows.map(c=>c.name).join(","),Be.confirm(`确定要删除用户 ${a} ，此操作将永久删除, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var c={ids:[]};if(e&&e.id)c.ids=[e.id];else{const f=i.selectedRows.map(u=>u.id);c.ids=f}ge(c)})},ge=e=>{He(e).then(a=>{a.code===2e4?(C.success("删除成功!"),b()):C.warning(a.msg)})},fe=()=>{if(i.selectedRows.length===0){var e=JSON.parse(JSON.stringify(i.queryParams));e.startDate=i.dateRange?T.startOfDay(i.dateRange[0]):"",e.endDate=i.dateRange?T.endOfDay(i.dateRange[1]):"",e.page=0,e.limit=1e3,console.log(JSON.stringify(e)),ee(e).then(a=>{const{data:c}=a;K(c)})}else K(i.selectedRows)},K=e=>{var a=e;a.forEach(u=>{u.deptName=Y(u.deptId,y.deptOptions),u.statusText=u.status==="0"?"停用":"启用",u.levelName=Y(u.level,y.levelOptions)}),lt(a,["name","levelName","phone","money","age","createDate","updateDate","statusText"],["操作人","级别","手机号","金额","年龄","创建时间","更新时间","状态"],"用户数据.xlsx")},_e=e=>{n.dialogType="look",n.dialogFormData=JSON.parse(JSON.stringify(e)),n.isShowDialog=!0},be=e=>{i.cellBtnLoading=e.id,setTimeout(()=>{i.cellBtnLoading=""},1500)},v=()=>{B.value.clearSelection()},De=()=>{n.isShowSelectDialog=!0},j=e=>{console.log("onSelectfinish",JSON.stringify(e))},he=()=>{n.isRefreshDialog=!1,We(()=>{n.isRefreshDialog=!0}),n.isShowAddProductDialog=!0},G=e=>{e?(n.dialogFormData=JSON.parse(JSON.stringify(e)),n.dialogType="edit",n.isShowDragDialog=!0):(n.dialogFormData={name:"",content:"",level:"",createDate:"",updateDate:"",isUse:"",status:"",phone:"",money:"",age:""},n.dialogType="add",n.isShowDragDialog=!0)},we=()=>{F.value.handleOpen()};return(e,a)=>{const c=Oe,f=Re,u=Ne,ye=Te,Q=Pe,r=Ee,Se=Je,p=Le,ve=Ve,ke=Ye,Ce=Fe,xe=Ue;return O(),X("div",null,[d("div",st,[l(Se,{inline:!0,model:o(g),class:"bs-form-search mt10"},{default:s(()=>[l(f,null,{default:s(()=>[it,l(c,{modelValue:o(g).name,"onUpdate:modelValue":a[0]||(a[0]=t=>o(g).name=t),maxlength:"20",placeholder:"请输入",clearable:"",onKeyup:Ie($,["enter","native"])},null,8,["modelValue"])]),_:1}),l(f,null,{default:s(()=>[nt,l(ye,{modelValue:o(g).level,"onUpdate:modelValue":a[1]||(a[1]=t=>o(g).level=t),placeholder:"请选择",filterable:"",clearable:""},{default:s(()=>[(O(!0),X($e,null,qe(o(M),t=>(O(),H(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(f,null,{default:s(()=>[dt,l(Q,{modelValue:o(N),"onUpdate:modelValue":a[2]||(a[2]=t=>D(N)?N.value=t:null),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",format:"YYYY年MM月DD日"},null,8,["modelValue"])]),_:1}),l(f,null,{default:s(()=>[l(r,{class:"bs-form-btn",type:"primary",onClick:$},{default:s(()=>[m("查询")]),_:1})]),_:1})]),_:1},8,["model"]),d("div",rt,[d("div",pt,[l(r,{type:"primary",icon:"i-ep-plus",onClick:me},{default:s(()=>[m(" 新增 ")]),_:1}),l(r,{type:"primary",icon:"i-ep-edit",disabled:o(P).length!==1,onClick:q},{default:s(()=>[m(" 编辑 ")]),_:1},8,["disabled"]),l(r,{type:"primary",icon:"i-ep-search",disabled:o(P).length!==1,onClick:ue},{default:s(()=>[m(" 查看 ")]),_:1},8,["disabled"]),l(r,{type:"warning",icon:"i-ep-download",onClick:fe},{default:s(()=>[m(" 导出 ")]),_:1}),l(r,{type:"danger",icon:"i-ep-delete",disabled:o(P).length==0,onClick:z},{default:s(()=>[m(" 删除 ")]),_:1},8,["disabled"]),l(r,{type:"primary",icon:"i-ep-plus",onClick:De},{default:s(()=>[m(" 选择 ")]),_:1}),l(r,{type:"primary",icon:"i-ep-plus",onClick:he},{default:s(()=>[m(" 添加产品 ")]),_:1}),l(r,{type:"primary",icon:"i-ep-plus",onClick:a[3]||(a[3]=t=>G())},{default:s(()=>[m(" 拖拽排序 ")]),_:1}),l(r,{class:"datePicker-btn",type:"primary",onClick:we},{default:s(()=>[m(" 弹出日期选择器 "),d("div",ct,[l(Q,{ref_key:"datePickerRef",ref:F,modelValue:o(S),"onUpdate:modelValue":a[4]||(a[4]=t=>D(S)?S.value=t:null),"picker-options":o(de),editable:!1,"value-format":"YYYY-MM-DD",format:"YYYY年MM月DD日"},null,8,["modelValue","picker-options"])])]),_:1}),d("span",mt,_(o(S)),1)]),Z((O(),H(ke,{ref_key:"tableRef",ref:B,class:"bs-table",data:o(ae),stripe:!0,"header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},onSelectionChange:pe},{default:s(()=>[l(p,{prop:"number",type:"index",label:"序号","min-width":"60"}),l(p,{type:"selection",width:"55",selectable:V}),l(p,{label:"操作人","min-width":"100"},{default:s(t=>[d("span",{onClick:k=>_e(t.row)},[d("a",gt,_(t.row.name),1)],8,ut)]),_:1}),l(p,{label:"状态"},{default:s(t=>[d("div",{style:ze({background:ce(t.row)}),class:"tagClass"},_(t.row.status==="0"?"停用":"启用"),5)]),_:1}),l(p,{prop:"isUse",label:"启用状态"},{header:s(()=>[ft,_t]),default:s(t=>[m(_(t.row.isUse==0?"停用":"启用"),1)]),_:1}),l(p,{label:"级别","min-width":"100"},{default:s(t=>[d("div",{class:Ke(t.row.level=="1"?"b-tag-success":t.row.level=="2"?"b-tag-warning":"b-tag-error")},_(Y(t.row.level,o(M))),3)]),_:1}),l(p,{prop:"isUse",label:"启用"},{default:s(t=>[m(_(t.row.isUse==0?"停用":"启用"),1)]),_:1}),l(p,{prop:"phone",label:"手机号","min-width":"200"}),l(p,{prop:"money",label:"金额",sortable:""}),l(p,{prop:"age",label:"年龄",sortable:""}),l(p,{prop:"createDate",label:"创建时间","min-width":"180"}),l(p,{prop:"updateDate",label:"更新时间","min-width":"180"}),l(p,{label:"备注","min-width":"200"},{default:s(t=>[l(ve,{"visible-arrow":!1,effect:"light",content:t.row.content,placement:"bottom"},{default:s(()=>[d("span",bt,_(t.row.content),1)]),_:2},1032,["content"])]),_:1}),l(p,{fixed:"right",label:"操作",width:"200"},{default:s(t=>[l(r,{size:"small",icon:"i-ep-edit",disabled:!V(t.row),onClick:k=>q(t.row)},null,8,["disabled","onClick"]),l(r,{size:"small",icon:"i-ep-delete",type:"danger",disabled:!V(t.row),onClick:k=>z(t.row)},null,8,["disabled","onClick"]),l(r,{size:"small",icon:"i-ep-rank",onClick:k=>G(t.row)},null,8,["onClick"]),l(r,{loading:o(le)===t.row.id,style:{margin:"6px 0px 0px"},size:"small",type:"success",onClick:k=>be(t.row)},{default:s(()=>[m("Print")]),_:2},1032,["loading","onClick"])]),_:1})]),_:1},8,["data"])),[[xe,o(te)]]),Z(l(Ce,{total:o(A),page:o(g).page,"onUpdate:page":a[5]||(a[5]=t=>o(g).page=t),limit:o(g).limit,"onUpdate:limit":a[6]||(a[6]=t=>o(g).limit=t),onPagination:b},null,8,["total","page","limit"]),[[je,o(A)>0]])]),l(Ze,{"is-show":o(E),"onUpdate:isShow":a[7]||(a[7]=t=>D(E)?E.value=t:null),"dialog-type":o(oe),"dialog-data":o(I),onSuccess:b,onClosed:v},null,8,["is-show","dialog-type","dialog-data"]),l(et,{"is-show":o(J),"onUpdate:isShow":a[8]||(a[8]=t=>D(J)?J.value=t:null),"dialog-data":o(se),onSelect:j,onClosed:v},null,8,["is-show","dialog-data"]),l(tt,{"is-show":o(U),"onUpdate:isShow":a[9]||(a[9]=t=>D(U)?U.value=t:null),"is-refresh":o(ie),onSuccess:j,onClosed:v},null,8,["is-show","is-refresh"]),l(at,{"is-show":o(L),"onUpdate:isShow":a[10]||(a[10]=t=>D(L)?L.value=t:null),"dialog-data":o(I),onSuccess:b,onClosed:v},null,8,["is-show","dialog-data"])])])}}}),oa=ot(Dt,[["__scopeId","data-v-6e09690d"]]);export{oa as default};
