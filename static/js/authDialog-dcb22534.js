import{b as y,c as W,T as X,U as z,V as Y,d as Z,N as ee}from"./element-plus-d9b7f19c.js";import{S as oe}from"./index-bdffb0d4.js";import{k as te,_ as ae}from"./index-fed18894.js";import{r as le}from"./role-ab26f65f.js";import{I as se}from"./@iconify-f08c9910.js";import{d as ie,r as ne,$ as ce,a0 as x,w as v,o as f,c as L,X as l,Q as s,R as de,a as r,W as _,u as a,l as C,V as p,P as N,U as re}from"./@vue-9ba90ccc.js";import"./lodash-es-d29772ce.js";import"./async-validator-dee29e8b.js";import"./@vueuse-f39d50a6.js";import"./dayjs-bff41acc.js";import"./@intlify-767c1c72.js";import"./source-map-7d7e1c08.js";import"./@element-plus-c398101b.js";import"./@ctrl-f8748455.js";import"./@sxzz-c75af06c.js";import"./escape-html-849d0975.js";import"./normalize-wheel-es-ed76fb12.js";import"./pinia-87603f94.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-c8173181.js";import"./crypto-js-49b96eff.js";import"./axios-4a70c6fc.js";import"./js-cookie-edb2da2a.js";import"./vue-i18n-1488b031.js";import"./vue-ef783175.js";import"./nprogress-84d8f06a.js";import"./mockjs-8d5feca7.js";import"./vite-plugin-mock-5220d95c.js";import"./path-to-regexp-36ea9d8d.js";const pe={class:"bs-dialog"},me={style:{margin:"-10px 0px 20px"}},ue={style:{padding:"0 5px 15px"}},ge={class:"tree-body"},fe={class:"bs-dialog-footer"},_e=ie({__name:"authDialog",props:{isShow:{type:Boolean,default:!1},dialogData:{type:Object,default:()=>({})}},emits:["update:isShow","closed","success"],setup(I,{emit:h}){const k=I,n=ne(),e=ce({dialogTitle:"权限设置",isShowDialog:!1,dialogSubmitBtnLoading:!1,dialogLoading:!1,roleData:{},menuTreeData:[],menuIdList:[],defaultProps:{label:"title",children:"children"},isExpandAll:!1,isSelectAll:!1,activeName:"first"}),{dialogTitle:T,isShowDialog:m,dialogSubmitBtnLoading:A,dialogLoading:E,roleData:V}=x(e),{menuTreeData:B,menuIdList:O,defaultProps:R,isExpandAll:D,isSelectAll:b,activeName:S}=x(e),w=t=>t&&t.includes(":"),J=t=>t&&!w(t);v(()=>k.isShow,t=>{e.isShowDialog=t}),v(()=>e.isShowDialog,t=>{h("update:isShow",t)}),v(()=>k.dialogData,t=>{e.roleData=JSON.parse(JSON.stringify(t))});const P=()=>{K()},U=()=>{h("closed",{})},K=()=>{const t={roleId:e.roleData.id};e.dialogLoading=!0,te(t).then(o=>{e.dialogLoading=!1,o.code===2e4?(e.menuTreeData=o.data.menuTree,e.menuIdList=o.data.menuIds):y.warning(o.msg)}).catch(o=>{e.dialogLoading=!1,console.log(JSON.stringify(o))})},M=()=>{e.isExpandAll=!e.isExpandAll;const t=n.value.store._getAllNodes();for(var o=0;o<t.length;o++)t[o].expanded=e.isExpandAll},$=()=>{e.isSelectAll=!e.isSelectAll,e.isSelectAll?n.value.setCheckedNodes(e.menuTreeData):n.value.setCheckedNodes([])},q=()=>{F()},F=()=>{const t=e.roleData.id,o=n.value.getCheckedKeys(),c=n.value.getHalfCheckedKeys(),u={roleId:t,menuIds:o.concat(c)};console.log(JSON.stringify(u)),e.dialogSubmitBtnLoading=!0,le(u).then(d=>{e.dialogSubmitBtnLoading=!1,d.code===2e4?(y.success("角色设置权限成功!"),e.isShowDialog=!1,h("success",{})):y.warning(d.msg)}).catch(d=>{e.dialogSubmitBtnLoading=!1,console.log(JSON.stringify(d))})};return(t,o)=>{const c=W,u=oe,d=X,H=z,j=Y,G=Z,Q=ee;return f(),L("div",null,[l(G,{title:a(T),modelValue:a(m),"onUpdate:modelValue":o[3]||(o[3]=i=>C(m)?m.value=i:null),top:"8vh",width:"55%","close-on-click-modal":!1,onOpened:P,onClosed:U},{default:s(()=>[de((f(),L("div",pe,[r("div",me,"选中角色："+_(a(V).name),1),l(j,{modelValue:a(S),"onUpdate:modelValue":o[0]||(o[0]=i=>C(S)?S.value=i:null),type:"card"},{default:s(()=>[l(H,{label:"菜单权限",name:"first"},{default:s(()=>[r("div",ue,[l(c,{type:"primary",icon:a(D)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:M},{default:s(()=>[p(_(a(D)?"全部收起":"全部展开"),1)]),_:1},8,["icon"]),l(c,{type:"primary",icon:a(b)?"i-ep-close":"i-ep-check",onClick:$},{default:s(()=>[p(_(a(b)?"全部取消":"全部选择"),1)]),_:1},8,["icon"])]),r("div",ge,[l(d,{ref_key:"treeRef",ref:n,data:a(B),"show-checkbox":"","check-on-click-node":!0,"node-key":"id","highlight-current":"","default-checked-keys":a(O),props:a(R)},{default:s(({node:i,data:g})=>[r("span",null,[w(g.icon)?(f(),N(a(se),{key:0,icon:g.icon,class:"iconFont"},null,8,["icon"])):J(g.icon)?(f(),N(u,{key:1,"icon-class":g.icon,class:"iconFont"},null,8,["icon-class"])):re("",!0),p(" "+_(i.label),1)])]),_:1},8,["data","default-checked-keys","props"])])]),_:1})]),_:1},8,["modelValue"]),r("div",fe,[l(c,{onClick:o[1]||(o[1]=i=>m.value=!1)},{default:s(()=>[p("取消")]),_:1}),l(c,{loading:a(A),type:"primary",onClick:o[2]||(o[2]=i=>q())},{default:s(()=>[p("保存")]),_:1},8,["loading"])])])),[[Q,a(E)]])]),_:1},8,["title","modelValue"])])}}});const je=ae(_e,[["__scopeId","data-v-ab149506"]]);export{je as default};
