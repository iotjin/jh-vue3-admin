import{b as m,k as ae,w as le,c as se,I as ne,J as ie,v as de,A as re,f as ce,B as me,d as pe,K as ue}from"./element-plus-Bdn4kiSG.js";import{ak as N,o as p,c as C,a as d,d as _e,r as ge,_ as fe,$ as E,w as L,f as he,W as o,P as l,V as be,u as n,l as Y,U as h,Q as I,O,bm as we,bk as De}from"./@vue-DBL8Ibom.js";import{g as ve}from"./role-BabOENuR.js";import{a as Se}from"./user-poya1pXY.js";import{_ as Ke}from"./index-DFeBoV3U.js";import"./lodash-es-Blijzk1b.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-BThtamsc.js";import"./dayjs-C6J0yRL_.js";import"./@intlify-CHY6szXs.js";import"./@sxzz-D9SI2xQl.js";import"./@element-plus-BmjHI8io.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-7g9vQp6f.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-fhvlCfPF.js";import"./crypto-js-CYDAzdEe.js";import"./axios-CCb-kr4I.js";import"./js-cookie-Cz0CWeBA.js";import"./vue-i18n-B8qYdFXi.js";import"./vue-rTnkxsfK.js";import"./vue-draggable-plus-BSvTyIk2.js";import"./nprogress-yi2QV7xY.js";import"./mockjs-DsSR4jwH.js";import"./vite-plugin-mock-CDJiH8Qs.js";import"./path-to-regexp-BzK_ZY7n.js";const Le={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ye=d("path",{fill:"currentColor",d:"M340.864 149.312a30.59 30.59 0 0 0 0 42.752L652.736 512L340.864 831.872a30.59 30.59 0 0 0 0 42.752a29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1),Ce=[Ye];function Re(r,b){return p(),C("svg",Le,[...Ce])}const xe=N({name:"ep-arrow-right",render:Re}),ke={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ye=d("path",{fill:"currentColor",d:"M609.408 149.376L277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0a30.59 30.59 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.59 30.59 0 0 0 0-42.688a29.12 29.12 0 0 0-41.728 0"},null,-1),Be=[ye];function $e(r,b){return p(),C("svg",ke,[...Be])}const Ve=N({name:"ep-arrow-left",render:$e}),R=r=>(we("data-v-e43ba289"),r=r(),De(),r),Ee={class:"bs-dialog input-width"},Ie={style:{margin:"-10px 0px 20px"}},Oe=R(()=>d("div",{class:"role-title"},"可分配角色",-1)),Ne={class:"role-search"},Je={class:"role-center"},Te=R(()=>d("br",null,null,-1)),Ue=R(()=>d("div",{class:"role-title"},"已分配角色",-1)),Ae={class:"role-search"},Me={class:"bs-dialog-footer",style:{"padding-top":"30px"}},ze=_e({__name:"assignRoleDialog",props:{isShow:{type:Boolean,default:!1},dialogData:{type:Object,default:()=>({})}},emits:["update:isShow","closed","success"],setup(r,{emit:b}){const w=b,x=r;ge();const e=fe({dialogTitle:"分配角色",isShowDialog:!1,dialogSubmitBtnLoading:!1,userData:{},tableHeight:400,isLoadingK:!1,nameK:"",tableDataK:[],selectedRowsK:[],isLoadingY:!1,nameY:"",tableDataY:[],selectedRowsY:[]}),{dialogTitle:J,isShowDialog:u,dialogSubmitBtnLoading:T}=E(e),{userData:U,tableHeight:k,isLoadingK:A,nameK:D,tableDataK:M,isLoadingY:z,nameY:v,tableDataY:q}=E(e);L(()=>x.isShow,a=>{e.isShowDialog=a}),L(()=>e.isShowDialog,a=>{w("update:isShow",a)}),L(()=>x.dialogData,a=>{e.userData=JSON.parse(JSON.stringify(a))}),he(()=>{});const F=()=>{_("K"),_("Y")},H=()=>{w("closed",{})},_=a=>{var t={userId:e.userData.id,name:"",status:""};t.name=a==="K"?e.nameK:e.nameY,t.status=a==="K"?"0":"1",console.log(JSON.stringify(t)),S(!0,a),ve(t).then(s=>{S(!1,a),s.code===2e4?a==="K"?e.tableDataK=s.data:e.tableDataY=s.data:m.warning(s.msg)}).catch(s=>{S(!1,a),console.log(JSON.stringify(s))})},S=(a,t)=>{t==="K"?e.isLoadingK=a:e.isLoadingY=a},j=a=>{e.selectedRowsK=a},P=a=>{e.selectedRowsY=a},Q=()=>{if(e.selectedRowsY.length===0){m.warning("请选择需要移除的已分配角色！");return}e.tableDataK=e.selectedRowsY.concat(e.tableDataK),e.tableDataY=e.tableDataY.filter(a=>!e.selectedRowsY.some(t=>a.id===t.id))},W=()=>{if(e.selectedRowsK.length===0){m.warning("请选择需要添加的可分配角色！");return}e.tableDataY=e.selectedRowsK.concat(e.tableDataY),e.tableDataK=e.tableDataK.filter(a=>!e.selectedRowsK.some(t=>a.id===t.id))},G=()=>{X()},X=()=>{const a=e.tableDataY.map(s=>s.id),t={id:e.userData.id,roleIds:a};console.log(JSON.stringify(t)),e.dialogSubmitBtnLoading=!0,Se(t).then(s=>{e.dialogSubmitBtnLoading=!1,s.code===2e4?(m.success("分配角色成功!"),e.isShowDialog=!1,w("success",{})):m.warning(s.msg)}).catch(s=>{e.dialogSubmitBtnLoading=!1,console.log(JSON.stringify(s))})};return(a,t)=>{const s=ae,g=le,f=se,c=ne,y=ie,B=de,K=re,Z=Ve,$=ce,ee=xe,te=me,oe=pe,V=ue;return p(),C("div",null,[o(oe,{title:n(J),modelValue:n(u),"onUpdate:modelValue":t[8]||(t[8]=i=>Y(u)?u.value=i:null),top:"8vh",width:"60%","close-on-click-modal":!1,onOpened:F,onClosed:H},{default:l(()=>[d("div",Ee,[d("div",Ie,"选中用户："+be(n(U).name),1),o(te,{gutter:10,class:"dialog-body"},{default:l(()=>[o(K,{span:11},{default:l(()=>[Oe,o(B,{inline:!0,class:"role-left"},{default:l(()=>[d("div",Ne,[o(g,null,{default:l(()=>[o(s,{modelValue:n(D),"onUpdate:modelValue":t[0]||(t[0]=i=>Y(D)?D.value=i:null),maxlength:"20",placeholder:"请输入角色名称",clearable:""},null,8,["modelValue"])]),_:1}),o(g,null,{default:l(()=>[o(f,{class:"bs-form-btn",type:"primary",onClick:t[1]||(t[1]=i=>_("K"))},{default:l(()=>[h("查询")]),_:1})]),_:1})]),I((p(),O(y,{data:n(M),"max-height":n(k),border:"",onSelectionChange:j},{default:l(()=>[o(c,{type:"selection"}),o(c,{prop:"name",label:"角色名称"}),o(c,{prop:"code",label:"角色编号"})]),_:1},8,["data","max-height"])),[[V,n(A)]])]),_:1})]),_:1}),o(K,{span:2},{default:l(()=>[d("div",Je,[o($,{size:22},{default:l(()=>[o(Z,{onClick:t[2]||(t[2]=i=>Q())})]),_:1}),Te,o($,{size:22},{default:l(()=>[o(ee,{onClick:t[3]||(t[3]=i=>W())})]),_:1})])]),_:1}),o(K,{span:11},{default:l(()=>[Ue,o(B,{inline:!0,class:"role-right"},{default:l(()=>[d("div",Ae,[o(g,null,{default:l(()=>[o(s,{modelValue:n(v),"onUpdate:modelValue":t[4]||(t[4]=i=>Y(v)?v.value=i:null),maxlength:"20",placeholder:"请输入角色名称",clearable:""},null,8,["modelValue"])]),_:1}),o(g,null,{default:l(()=>[o(f,{class:"bs-form-btn",type:"primary",onClick:t[5]||(t[5]=i=>_("Y"))},{default:l(()=>[h("查询")]),_:1})]),_:1})]),I((p(),O(y,{data:n(q),"max-height":n(k),border:"",onSelectionChange:P},{default:l(()=>[o(c,{type:"selection"}),o(c,{prop:"name",label:"角色名称"}),o(c,{prop:"code",label:"角色编号"})]),_:1},8,["data","max-height"])),[[V,n(z)]])]),_:1})]),_:1})]),_:1}),d("div",Me,[o(f,{onClick:t[6]||(t[6]=i=>u.value=!1)},{default:l(()=>[h("取消")]),_:1}),o(f,{loading:n(T),type:"primary",onClick:t[7]||(t[7]=i=>G())},{default:l(()=>[h("保存")]),_:1},8,["loading"])])])]),_:1},8,["title","modelValue"])])}}}),ht=Ke(ze,[["__scopeId","data-v-e43ba289"]]);export{ht as default};
