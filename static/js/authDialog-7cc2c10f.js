import{c as y,w as W,R as X,S as z,T as Y,k as Z,L as ee}from"./element-plus-5134355a.js";import{S as oe}from"./index-24a8e899.js";import{e as te}from"./index-e467e329.js";import{r as ae}from"./role-239c41a8.js";import{I as le}from"./@iconify-5142df58.js";import{d as se,r as ie,$ as ne,a0 as x,w as v,o as f,c as L,X as l,Q as s,R as ce,a as r,W as _,u as a,l as C,V as p,P as I,U as de}from"./@vue-7d0fc2b4.js";import{_ as re}from"./plugin-vueexport-helper-c27b6911.js";import"./lodash-es-d29772ce.js";import"./async-validator-dee29e8b.js";import"./@vueuse-d1e6df39.js";import"./dayjs-78f57161.js";import"./@intlify-999e9484.js";import"./source-map-7d7e1c08.js";import"./@element-plus-14994921.js";import"./@ctrl-f8748455.js";import"./@sxzz-c75af06c.js";import"./escape-html-bdfaebd7.js";import"./normalize-wheel-es-ed76fb12.js";import"./pinia-4649f5ad.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-98b533fa.js";import"./axios-4a70c6fc.js";import"./vue-i18n-625cf0a6.js";import"./vue-ff9293da.js";import"./js-cookie-edb2da2a.js";import"./nprogress-941844a1.js";import"./mockjs-3c670f17.js";import"./vite-plugin-mock-8bbc2346.js";import"./path-to-regexp-36ea9d8d.js";const pe={class:"bs-dialog"},me={style:{margin:"-10px 0px 20px"}},ue={style:{padding:"0 5px 15px"}},ge={class:"tree-body"},fe={class:"bs-dialog-footer"},_e=se({__name:"authDialog",props:{isShow:{type:Boolean,default:!1},dialogData:{type:Object,default:()=>({})}},emits:["update:isShow","closed","success"],setup(N,{emit:h}){const k=N,n=ie(),e=ne({dialogTitle:"权限设置",isShowDialog:!1,dialogSubmitBtnLoading:!1,dialogLoading:!1,roleData:{},menuTreeData:[],menuIdList:[],defaultProps:{label:"title",children:"children"},isExpandAll:!1,isSelectAll:!1,activeName:"first"}),{dialogTitle:T,isShowDialog:m,dialogSubmitBtnLoading:A,dialogLoading:E,roleData:B}=x(e),{menuTreeData:V,menuIdList:O,defaultProps:R,isExpandAll:D,isSelectAll:b,activeName:S}=x(e),w=t=>t&&t.includes(":"),J=t=>t&&!w(t);v(()=>k.isShow,t=>{e.isShowDialog=t}),v(()=>e.isShowDialog,t=>{h("update:isShow",t)}),v(()=>k.dialogData,t=>{e.roleData=JSON.parse(JSON.stringify(t))});const P=()=>{M()},K=()=>{h("closed",{})},M=()=>{const t={roleId:e.roleData.id};e.dialogLoading=!0,te(t).then(o=>{e.dialogLoading=!1,o.code===2e4?(e.menuTreeData=o.data.menuTree,e.menuIdList=o.data.menuIds):y.warning(o.msg)}).catch(o=>{e.dialogLoading=!1,console.log(JSON.stringify(o))})},U=()=>{e.isExpandAll=!e.isExpandAll;const t=n.value.store._getAllNodes();for(var o=0;o<t.length;o++)t[o].expanded=e.isExpandAll},$=()=>{e.isSelectAll=!e.isSelectAll,e.isSelectAll?n.value.setCheckedNodes(e.menuTreeData):n.value.setCheckedNodes([])},q=()=>{F()},F=()=>{const t=e.roleData.id,o=n.value.getCheckedKeys(),c=n.value.getHalfCheckedKeys(),u={roleId:t,menuIds:o.concat(c)};console.log(JSON.stringify(u)),e.dialogSubmitBtnLoading=!0,ae(u).then(d=>{e.dialogSubmitBtnLoading=!1,d.code===2e4?(y.success("角色设置权限成功!"),e.isShowDialog=!1,h("success",{})):y.warning(d.msg)}).catch(d=>{e.dialogSubmitBtnLoading=!1,console.log(JSON.stringify(d))})};return(t,o)=>{const c=W,u=oe,d=X,H=z,j=Y,G=Z,Q=ee;return f(),L("div",null,[l(G,{title:a(T),modelValue:a(m),"onUpdate:modelValue":o[3]||(o[3]=i=>C(m)?m.value=i:null),top:"8vh",width:"55%","close-on-click-modal":!1,onOpened:P,onClosed:K},{default:s(()=>[ce((f(),L("div",pe,[r("div",me,"选中角色："+_(a(B).name),1),l(j,{modelValue:a(S),"onUpdate:modelValue":o[0]||(o[0]=i=>C(S)?S.value=i:null),type:"card"},{default:s(()=>[l(H,{label:"菜单权限",name:"first"},{default:s(()=>[r("div",ue,[l(c,{type:"primary",icon:a(D)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:U},{default:s(()=>[p(_(a(D)?"全部收起":"全部展开"),1)]),_:1},8,["icon"]),l(c,{type:"primary",icon:a(b)?"i-ep-close":"i-ep-check",onClick:$},{default:s(()=>[p(_(a(b)?"全部取消":"全部选择"),1)]),_:1},8,["icon"])]),r("div",ge,[l(d,{ref_key:"treeRef",ref:n,data:a(V),"show-checkbox":"","check-on-click-node":!0,"node-key":"id","highlight-current":"","default-checked-keys":a(O),props:a(R)},{default:s(({node:i,data:g})=>[r("span",null,[w(g.icon)?(f(),I(a(le),{key:0,icon:g.icon,class:"iconFont"},null,8,["icon"])):J(g.icon)?(f(),I(u,{key:1,"icon-class":g.icon,class:"iconFont"},null,8,["icon-class"])):de("",!0),p(" "+_(i.label),1)])]),_:1},8,["data","default-checked-keys","props"])])]),_:1})]),_:1},8,["modelValue"]),r("div",fe,[l(c,{onClick:o[1]||(o[1]=i=>m.value=!1)},{default:s(()=>[p("取消")]),_:1}),l(c,{loading:a(A),type:"primary",onClick:o[2]||(o[2]=i=>q())},{default:s(()=>[p("保存")]),_:1},8,["loading"])])])),[[Q,a(E)]])]),_:1},8,["title","modelValue"])])}}});const je=re(_e,[["__scopeId","data-v-ab149506"]]);export{je as default};
