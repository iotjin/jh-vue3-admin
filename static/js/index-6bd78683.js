import{b as k,a as ne,j as ie,w as se,c as de,v as re,L as ce,M as pe,N as me}from"./element-plus-f5d3fc50.js";import{S as ue}from"./index-50a4f576.js";import{d as ge,r as fe,$ as C,a0 as T,i as _e,ao as be,o as u,c as ye,X as a,Q as s,u as l,af as O,V as g,a as m,R as f,P as _,W as x,U as he,S as we,l as xe,bh as ve,bf as Se}from"./@vue-9ba90ccc.js";import{l as De,m as ke,_ as Ce}from"./index-f131ee7d.js";import{d as Te,A as Ee}from"./addDialog-2d53f641.js";import{I as Ie}from"./@iconify-f08c9910.js";import"./lodash-es-d29772ce.js";import"./async-validator-dee29e8b.js";import"./@vueuse-f39d50a6.js";import"./dayjs-bff41acc.js";import"./@intlify-767c1c72.js";import"./source-map-7d7e1c08.js";import"./@element-plus-c398101b.js";import"./@ctrl-f8748455.js";import"./@sxzz-c75af06c.js";import"./escape-html-849d0975.js";import"./normalize-wheel-es-ed76fb12.js";import"./pinia-87603f94.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-c8173181.js";import"./crypto-js-49b96eff.js";import"./axios-4a70c6fc.js";import"./js-cookie-edb2da2a.js";import"./vue-i18n-1488b031.js";import"./vue-ef783175.js";import"./nprogress-84d8f06a.js";import"./mockjs-8d5feca7.js";import"./vite-plugin-mock-5220d95c.js";import"./path-to-regexp-36ea9d8d.js";import"./select-tree-e745af29.js";const F=w=>(ve("data-v-9caf665a"),w=w(),Se(),w),Re={class:"bs-page-body"},Ae=F(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单名称:")],-1)),Ne=F(()=>m("span",{class:"bs-form-label",style:{width:"120px"}},[m("span",{class:"icon"},"菜单编码:")],-1)),Ve={class:"bs-page-table"},Le={class:"bs-table-btns"},Oe=["onClick"],Fe={style:{color:"#00a0e9","text-decoration":"underline"}},Je=ge({__name:"index",setup(w){const v=fe(),n=C({tableLoading:!1,tableData:[],queryParams:{title:"",code:""},selectedRows:[],isExpandAll:!1,treeProps:{children:"children",hasChildren:"hasChildren"}}),{tableLoading:J,tableData:B,queryParams:h,selectedRows:S,isExpandAll:E,treeProps:P}=T(n),M=C({menuTypeOptions:Te}),{menuTypeOptions:q}=T(M),d=C({isShowDialog:!1,dialogType:"",dialogFormData:{},dialogTreeData:[]}),{isShowDialog:D,dialogType:K,dialogFormData:$,dialogTreeData:U}=T(d),I=e=>e&&e.includes(":"),z=e=>e&&!I(e);_e(()=>{b()});const b=()=>{var e=JSON.parse(JSON.stringify(n.queryParams));console.log(JSON.stringify(e)),n.tableLoading=!0,De(e).then(t=>{n.tableLoading=!1,t.code===2e4?n.tableData=t.data:k.warning(t.msg)}).catch(t=>{n.tableLoading=!1,console.log(JSON.stringify(t))})},j=({row:e,column:t,rowIndex:i,columnIndex:c})=>t.label==="菜单名称"?{textAlign:"left",paddingLeft:"10px"}:{textAlign:"center"},G=({row:e,column:t,rowIndex:i,columnIndex:c})=>({textAlign:t.label==="菜单名称"?"left":"center"}),Q=e=>"b-tag b-tag-"+e.menuType,W=e=>{n.selectedRows=e},X=(e,t)=>{const i=t.findIndex(c=>c.value===e);if(i!==-1)return t[i].label},H=()=>{d.dialogType="add",d.dialogFormData={},d.dialogTreeData=n.tableData,d.isShowDialog=!0},R=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="edit",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},A=e=>{const t=JSON.parse(JSON.stringify(e&&e.id?e:n.selectedRows[0]));d.dialogType="look",d.dialogFormData=t,d.dialogTreeData=n.tableData,d.isShowDialog=!0},N=e=>{var t="";e&&e.id?t=e.title:t=n.selectedRows.map(i=>i.title).join(","),ne.confirm(`确定要删除菜单 ${t} （如果包含子菜单，将一并删除），此操作将永久删除, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var i={ids:[]};if(e&&e.id)i.ids=[e.id];else{const c=n.selectedRows.map(r=>r.id);i.ids=c}Y(i)})},Y=e=>{console.log(JSON.stringify(e)),ke(e).then(t=>{t.code===2e4?(k.success("删除成功!"),b()):k.warning(t.msg)})},Z=()=>{n.isExpandAll=!n.isExpandAll,V(n.tableData,n.isExpandAll)},V=(e,t)=>{e.forEach(i=>{v.value.toggleRowExpansion(i,t),i.children!==void 0&&i.children!==null&&V(i.children,t)})},ee=()=>{v.value.clearSelection()};return(e,t)=>{const i=ie,c=se,r=de,te=re,p=ce,oe=ue,ae=pe,y=be("hasPerm"),le=me;return u(),ye("div",Re,[a(te,{inline:!0,model:l(h),class:"bs-form-search mt10"},{default:s(()=>[a(c,null,{default:s(()=>[Ae,a(i,{modelValue:l(h).title,"onUpdate:modelValue":t[0]||(t[0]=o=>l(h).title=o),maxlength:"20",placeholder:"请输入菜单名称",clearable:"",onKeyup:O(b,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),a(c,null,{default:s(()=>[Ne,a(i,{modelValue:l(h).code,"onUpdate:modelValue":t[1]||(t[1]=o=>l(h).code=o),maxlength:"20",placeholder:"请输入菜单编码",clearable:"",onKeyup:O(b,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),a(c,null,{default:s(()=>[a(r,{class:"bs-form-btn",type:"primary",onClick:b},{default:s(()=>[g("查询")]),_:1})]),_:1})]),_:1},8,["model"]),m("div",Ve,[m("div",Le,[f((u(),_(r,{type:"primary",icon:"i-ep-plus",onClick:H},{default:s(()=>[g(" 新增 ")]),_:1})),[[y,["menu-add"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-edit",disabled:l(S).length!==1,onClick:R},{default:s(()=>[g(" 编辑 ")]),_:1},8,["disabled"])),[[y,["menu-edit"]]]),f((u(),_(r,{type:"primary",icon:"i-ep-search",disabled:l(S).length!==1,onClick:A},{default:s(()=>[g(" 查看 ")]),_:1},8,["disabled"])),[[y,["menu-look"]]]),f((u(),_(r,{type:"danger",icon:"i-ep-delete",disabled:l(S).length!==1,onClick:N},{default:s(()=>[g(" 删除 ")]),_:1},8,["disabled"])),[[y,["menu-delete"]]]),a(r,{plain:"",icon:l(E)?"i-ep-arrow-down":"i-ep-arrow-right",onClick:Z},{default:s(()=>[g(x(l(E)?"全部收起":"全部展开"),1)]),_:1},8,["icon"])]),f((u(),_(ae,{ref_key:"tableRef",ref:v,class:"bs-table",data:l(B),"tree-props":l(P),"row-key":"id","default-expand-all":!1,stripe:!0,"header-cell-style":j,"cell-style":G,onSelectionChange:W},{default:s(()=>[a(p,{type:"selection",width:"55px"}),a(p,{label:"菜单名称","min-width":"200px"},{default:s(o=>[m("span",{onClick:L=>A(o.row)},[m("a",Fe,[I(o.row.icon)?(u(),_(l(Ie),{key:0,icon:o.row.icon,class:"iconFont"},null,8,["icon"])):z(o.row.icon)?(u(),_(oe,{key:1,"icon-class":o.row.icon,class:"iconFont"},null,8,["icon-class"])):he("",!0),g(" "+x(o.row.title),1)])],8,Oe)]),_:1}),a(p,{label:"菜单类型","min-width":"100"},{default:s(o=>[m("div",{class:we(Q(o.row))},x(X(o.row.menuType,l(q))),3)]),_:1}),a(p,{prop:"code",label:"菜单编码","min-width":"170px"}),a(p,{prop:"sort",label:"排序"}),a(p,{label:"可见"},{default:s(o=>[g(x(o.row.menuType==="button"?"":o.row.hidden?"隐藏":"显示"),1)]),_:1}),a(p,{prop:"component",label:"组件路径","min-width":"220px"}),a(p,{prop:"parentTitle",label:"上级菜单"}),a(p,{fixed:"right",label:"操作",width:"120"},{default:s(o=>[f(a(r,{size:"small",icon:"i-ep-edit",onClick:L=>R(o.row)},null,8,["onClick"]),[[y,["menu-edit"]]]),f(a(r,{size:"small",icon:"i-ep-delete",type:"danger",onClick:L=>N(o.row)},null,8,["onClick"]),[[y,["menu-delete"]]])]),_:1})]),_:1},8,["data","tree-props"])),[[le,l(J)]])]),a(Ee,{"dialog-type":l(K),"is-show":l(D),"onUpdate:isShow":t[2]||(t[2]=o=>xe(D)?D.value=o:null),"dialog-data":l($),"dialog-tree-data":l(U),onSuccess:b,onClosed:ee},null,8,["dialog-type","is-show","dialog-data","dialog-tree-data"])])}}});const gt=Ce(Je,[["__scopeId","data-v-9caf665a"]]);export{gt as default};
